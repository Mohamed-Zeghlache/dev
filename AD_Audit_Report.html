<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Active Directory Audit Report</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif; 
            margin: 0; padding: 20px 40px; 
            background: linear-gradient(to bottom right, #f8fafc 0%, #e2e8f0 100%);
            min-height: 100vh; 
            line-height: 1.5;
            font-size: 14px;
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 0 20px;
        }
        
        /* Header styling - cleaner and more professional */
        .header { 
            background: white;
            color: #1e293b; 
            padding: 40px 50px; 
            border-radius: 12px; 
            margin-bottom: 32px; 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            border-left: 4px solid #3b82f6;
        }
        .header h1 { margin: 0 0 20px 0; font-size: 2rem; font-weight: 700; color: #1e293b; }
        .header p { margin: 6px 0; color: #64748b; font-size: 0.875rem; }
        
        /* Section styling - reduced shadows and better spacing */
        .section { 
            background: white;
            margin: 24px 0; 
            padding: 32px 40px; 
            border-radius: 12px; 
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            border: 1px solid #e2e8f0;
        }
        .section h2 { 
            color: #1e293b; 
            border-bottom: 2px solid #e2e8f0; 
            padding-bottom: 16px; 
            margin-bottom: 28px; 
            font-weight: 600; 
            font-size: 1.375rem;
        }
        .section h3 {
            color: #334155;
            margin-top: 32px;
            margin-bottom: 20px;
            font-size: 1.125rem;
            font-weight: 600;
        }
        .section h4 {
            color: #374151;
            margin-top: 24px;
            margin-bottom: 16px;
            font-size: 1rem;
            font-weight: 600;
        }
        .section p {
            margin-bottom: 16px;
            color: #4b5563;
        }
        
        /* Alert boxes - softer colors and better contrast */
        .warning { 
            background: #fef3c7; 
            border: 1px solid #f59e0b; 
            color: #92400e;
            padding: 20px 24px; 
            border-radius: 8px; 
            margin: 24px 0;
            border-left: 4px solid #f59e0b;
            font-size: 0.875rem;
        }
        .error { 
            background: #fee2e2; 
            border: 1px solid #ef4444; 
            color: #991b1b;
            padding: 20px 24px; 
            border-radius: 8px; 
            margin: 24px 0;
            border-left: 4px solid #ef4444;
            font-size: 0.875rem;
        }
        .success {
            background: #dcfce7;
            border: 1px solid #22c55e;
            color: #166534;
            padding: 20px 24px;
            border-radius: 8px;
            margin: 24px 0;
            border-left: 4px solid #22c55e;
            font-size: 0.875rem;
        }
        .info {
            background: #e0f2fe;
            border: 1px solid #0284c7;
            color: #0c4a6e;
            padding: 20px 24px;
            border-radius: 8px;
            margin: 24px 0;
            border-left: 4px solid #0284c7;
            font-size: 0.875rem;
        }

        table { width: 100%; border-collapse: collapse; margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        th, td { border: none; padding: 12px 15px; text-align: left; }
        th { background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); color: white; font-weight: 500; }
        tr:nth-child(even) { background-color: rgba(52,152,219,0.05); }
        
        /* Status-specific row styling */
        .table .table-success {
            background-color: #d4edda !important;
            color: #155724;
        }
        
        .table .table-warning {
            background-color: #fff3cd !important;
            color: #856404;
        }
        
        .table .table-danger {
            background-color: #f8d7da !important;
            color: #721c24;
        }
        
        .table .table-info {
            background-color: #d1ecf1 !important;
            color: #0c5460;
        }

        /* Direct info class for table rows */
        tr.info {
            background-color: #e0f2fe !important;
            color: #0c4a6e;
        }

        tr.info td {
            background-color: #e0f2fe !important;
            color: #0c4a6e;
        }

        /* Info header styling */
        h5.info {
            color: #0c4a6e;
            background-color: #e0f2fe;
            padding: 8px 12px;
            border-radius: 4px;
            border-left: 3px solid #0284c7;
            margin: 16px 0 8px 0;
        }
        
        .table .table-primary {
            background-color: #cce7ff !important;
            color: #004085;
        }

        /* Table cell specific status styling (without heavy padding) */
        td.success {
            background-color: #dcfce7 !important;
            color: #166534;
            font-weight: 500;
        }

        td.warning {
            background-color: #fef3c7 !important;
            color: #92400e;
            font-weight: 500;
        }

        td.error {
            background-color: #fee2e2 !important;
            color: #991b1b;
            font-weight: 500;
        }

        /* Badge-like status indicators - subtle styling */
        .badge {
            display: inline-block;
            padding: 2px 6px;
            font-size: 0.75rem;
            font-weight: 600;
            line-height: 1.2;
            text-align: center;
            white-space: nowrap;
            vertical-align: baseline;
            border-radius: 12px;
            border: 1px solid;
        }

        .badge-success {
            color: #166534;
            background-color: transparent;
            border-color: #166534;
        }

        .badge-warning {
            color: #92400e;
            background-color: transparent;
            border-color: #92400e;
        }

        .badge-danger {
            color: #991b1b;
            background-color: transparent;
            border-color: #991b1b;
        }

        .badge-info {
            color: #0c5460;
            background-color: transparent;
            border-color: #0c5460;
        }

        .badge-primary {
            color: #004085;
            background-color: transparent;
            border-color: #004085;
        }
        
        .badge-secondary {
            color: #fff;
            background-color: #6c757d;
        }
        
        /* Metric cards - more subtle and professional */
        .metric { 
            display: inline-block; 
            margin: 8px; 
            padding: 16px; 
            background: white; 
            border-radius: 8px; 
            text-align: center; 
            min-width: 120px; 
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease; 
            position: relative;
        }
        .metric:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .metric .number { 
            font-size: 1.75rem; 
            font-weight: 700; 
            color: #1e293b; 
            margin-bottom: 10px; 
        }
        .metric .label { 
            font-size: 0.8rem; 
            color: #64748b; 
            font-weight: 500;
            line-height: 1.3;
        }
        
        /* Export button styling */
        .export-btn { 
            position: absolute; 
            top: 8px; 
            right: 8px; 
            background: #3b82f6; 
            color: white; 
            border: none; 
            border-radius: 6px; 
            width: 28px; 
            height: 28px; 
            font-size: 12px; 
            cursor: pointer; 
            opacity: 0.7; 
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .export-btn:hover { 
            background: #2563eb; 
            opacity: 1;
            transform: scale(1.1);
        }
        
        /* Tree and toggle styling */
        .ou-tree, .group-tree { margin: 20px 0; }
        .ou-item, .group-item { margin: 2px 0; }
        .ou-toggle, .group-toggle { 
            cursor: pointer; 
            user-select: none; 
            padding: 8px 12px; 
            border-radius: 6px; 
            transition: all 0.2s ease; 
            display: inline-block;
            color: #374151;
        }
        .ou-toggle:hover, .group-toggle:hover { 
            background: #f3f4f6;
            color: #1f2937;
        }
        .ou-toggle::before, .group-toggle::before { 
            content: '▶'; 
            display: inline-block; 
            width: 12px; 
            color: #6b7280; 
            font-size: 10px; 
            transition: transform 0.2s ease; 
        }
        .ou-toggle.expanded::before, .group-toggle.expanded::before { 
            content: '▼'; 
            transform: rotate(0deg); 
        }
        .ou-children, .group-children { 
            margin-left: 20px; 
            display: none; 
            border-left: 2px solid #e5e7eb; 
            padding-left: 12px; 
            margin-top: 4px; 
        }
        .ou-children.show, .group-children.show { 
            display: block; 
            animation: fadeIn 0.2s ease; 
        }
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(-4px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        
        /* Stats and level styling */
        .ou-stats, .group-stats { 
            font-size: 0.75rem; 
            color: #6b7280; 
            margin-left: 8px; 
            background: #f3f4f6; 
            padding: 2px 8px; 
            border-radius: 12px; 
            display: inline-block; 
        }
        .ou-level-0 { margin-left: 0px; }
        .ou-level-1 { margin-left: 16px; }
        .ou-level-2 { margin-left: 32px; }
        .ou-level-3 { margin-left: 48px; }
        .ou-level-4 { margin-left: 64px; }
        .ou-level-5 { margin-left: 80px; }
        
        /* Group tree styling */
        .group-tree { 
            max-height: 500px; 
            overflow-y: auto; 
            border: 1px solid #e5e7eb; 
            padding: 16px; 
            border-radius: 8px; 
            background: #fafafa; 
        }
        .group-tree::-webkit-scrollbar { width: 6px; }
        .group-tree::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 3px; }
        .group-tree::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .group-tree::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        .group-name { font-weight: 600; color: #374151; }
        .group-scope { 
            font-size: 0.75rem; 
            color: #6b7280; 
            margin-left: 6px; 
            background: #e5e7eb; 
            padding: 2px 6px; 
            border-radius: 8px; 
        }
        
        /* Risk level styling */
        .high-risk { color: #dc2626; font-weight: 600; }
        .medium-risk { color: #d97706; font-weight: 500; }
        .low-risk { color: #059669; font-weight: 500; }
        
        /* Controls panel */
        .controls-panel { 
            margin: 28px 0; 
            padding: 24px; 
            background: #f8fafc; 
            border-radius: 8px; 
            border: 1px solid #e2e8f0; 
        }
        .control-btn { 
            margin: 6px; 
            padding: 10px 20px; 
            background: #3b82f6; 
            color: white; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer; 
            font-weight: 500; 
            transition: all 0.2s ease;
            font-size: 0.8rem;
        }
        .control-btn:hover { 
            background: #2563eb; 
            transform: translateY(-1px);
        }
        .control-btn:active { transform: translateY(0px); }
        
        /* Template styling */
        .template-list { margin: 12px 0; }
        .template-tag { 
            display: inline-block; 
            margin: 4px 6px 4px 0; 
            padding: 6px 12px; 
            background: #eff6ff; 
            border: 1px solid #3b82f6; 
            border-radius: 16px; 
            font-size: 0.75rem; 
            color: #1e40af; 
            font-weight: 500; 
            transition: all 0.2s ease; 
        }
        .template-tag:hover { 
            background: #dbeafe;
            box-shadow: 0 2px 4px rgba(59, 130, 246, 0.1);
        }
        
        /* Status indicators */
        .status-indicator { 
            display: flex; 
            align-items: center; 
            margin: 12px 0; 
            padding: 12px 16px; 
            border-radius: 8px; 
            font-weight: 500; 
        }
        .status-indicator.success { 
            background: #dcfce7; 
            border: 1px solid #22c55e; 
            color: #166534; 
        }
        .status-indicator.warning { 
            background: #fef3c7; 
            border: 1px solid #f59e0b; 
            color: #92400e; 
        }
        .status-indicator .status-icon { margin-right: 8px; font-size: 16px; }
        .status.success {
            color: #166534;
            font-weight: 600;
            border-left: 2px solid #166534;
            padding-left: 6px;
        }
        .status.warning {
            color: #92400e;
            font-weight: 600;
            border-left: 2px solid #92400e;
            padding-left: 6px;
        }
        .status.error {
            color: #991b1b;
            font-weight: 600;
            border-left: 2px solid #991b1b;
            padding-left: 6px;
        }
        
        .info-grid { margin: 12px 0; }
        .info-grid p { margin: 6px 0; }
        
        /* Responsive design improvements */
        @media (max-width: 768px) {
            body { padding: 12px 16px; font-size: 13px; }
            .container { max-width: 100%; padding: 0 10px; }
            .header { padding: 24px 20px; }
            .header h1 { font-size: 1.5rem; }
            .section { padding: 20px 24px; margin: 16px 0; }
            .metric { min-width: 110px; margin: 6px; padding: 14px; }
            .metric .number { font-size: 1.5rem; }
            .metric .label { font-size: 0.75rem; }
            table { font-size: 0.8rem; }
            th, td { padding: 10px 14px; }
            .section h2 { font-size: 1.25rem; }
            .section h3 { font-size: 1rem; }
        }
        
        @media (max-width: 480px) {
            body { padding: 8px 12px; }
            .header { padding: 20px 16px; }
            .section { padding: 16px 20px; }
            .metric { min-width: 90px; margin: 4px; padding: 12px; }
        }
        
        /* Status indicators with left border styling - more subtle and professional */
        .status-online {
            border-left: 4px solid #10b981 !important;
            background-color: rgba(16, 185, 129, 0.05) !important;
            padding-left: 12px !important;
        }
        .status-warning {
            border-left: 4px solid #f59e0b !important;
            background-color: rgba(245, 158, 11, 0.05) !important;
            padding-left: 12px !important;
        }
        .status-error {
            border-left: 4px solid #ef4444 !important;
            background-color: rgba(239, 68, 68, 0.05) !important;
            padding-left: 12px !important;
        }
        .status-unknown {
            border-left: 4px solid #6b7280 !important;
            background-color: rgba(107, 114, 128, 0.05) !important;
            padding-left: 12px !important;
        }

        /* DNS Table specific styles */
        .table-responsive {
            overflow-x: auto;
            margin-bottom: 1rem;
        }

        .dns-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            background: white;
        }

        .dns-table th {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            font-weight: 500;
            padding: 12px 15px;
            text-align: left;
            border: none;
        }

        .dns-table td {
            padding: 12px 15px;
            border: none;
            border-bottom: 1px solid #e2e8f0;
        }

        .dns-table tr:nth-child(even) {
            background-color: rgba(52,152,219,0.03);
        }

        .dns-table tr:hover {
            background-color: rgba(52,152,219,0.08);
        }

        .dns-table .status {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .dns-table .status.success {
            color: #166534;
            font-weight: 600;
            border-left: 3px solid #166534;
            padding-left: 8px;
        }

        .dns-table .status.warning {
            color: #92400e;
            font-weight: 600;
            border-left: 3px solid #92400e;
            padding-left: 8px;
        }

        .dns-table .status.error {
            color: #991b1b;
            font-weight: 600;
            border-left: 3px solid #991b1b;
            padding-left: 8px;
        }

        @media (max-width: 768px) {
            .dns-table {
                font-size: 0.875rem;
            }

            .dns-table th,
            .dns-table td {
                padding: 8px 10px;
            }
        }

        .fsmo-summary { 
            margin-top: 16px; 
            padding: 12px 16px; 
            border-radius: 8px; 
            font-weight: 500;
        }
    </style>
    <script>
        function exportToCSV(data, filename) {
            // Function to properly escape CSV fields
            function escapeCSVField(field) {
                if (field === null || field === undefined) {
                    return '';
                }
                const stringField = String(field);
                // If field contains comma, quotes, or newlines, wrap in quotes and escape internal quotes
                if (stringField.includes(',') || stringField.includes('"') || stringField.includes('\n') || stringField.includes('\r')) {
                    return '"' + stringField.replace(/"/g, '""') + '"';
                }
                return stringField;
            }
            
            const csvContent = "data:text/csv;charset=utf-8," + 
                data.map(row => row.map(field => escapeCSVField(field)).join(",")).join("\n");
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", filename);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        function exportUserStats() {
            const userStats = [
                ["Metric", "Count"],
                ["Total Users", "12"],
                ["Enabled Users", "7"],
                ["Disabled Users", "5"],
                ["Password Never Expires", "3"],
                ["Inactive 90+ Days", "0"],
                ["Locked Out Users", "0"]
            ];
            exportToCSV(userStats, "user_statistics.csv");
        }
        
        function exportComputerStats() {
            const computerStats = [
                ["Metric", "Count"],
                ["Total Computers", "3"],
                ["Enabled Computers", "3"],
                ["Disabled Computers", "0"],
                ["Windows Servers", "2"],
                ["Windows Workstations", "1"],
                ["Inactive 90+ Days", "0"]
            ];
            exportToCSV(computerStats, "computer_statistics.csv");
        }
        
        // Individual metric export functions
        function exportEnabledUsers() {
            const data = [
                ["Name", "SamAccountName", "Last Logon", "Password Last Set"],
                ["adminuser", "adminuser", "09/15/2025 21:38:00", "09/11/2025 22:28:04"],                 ["Hamid Cherifi", "hamid.cherifi", "", "06/17/2025 08:02:51"],                 ["admin utilisateur", "adminu", "", "08/16/2025 15:58:55"],                 ["test user20", "tuser20", "", "08/16/2025 17:04:53"],                 ["test user2", "tuser2", "", "08/16/2025 17:05:47"],                 ["Mohamed", "zmohamed", "", "08/17/2025 12:52:25"],                 ["zmohamed", "m.mohamed", "", "08/17/2025 13:19:47"],
            ];
            exportToCSV(data, "enabled_users.csv");
        }
        
        function exportDisabledUsers() {
            const data = [
                ["Name", "SamAccountName", "Last Logon", "Password Last Set"],
                ["Guest", "Guest", "", ""],                 ["krbtgt", "krbtgt", "", "06/16/2025 21:22:03"],                 ["test user", "tuser", "", "08/16/2025 17:02:18"],                 ["Abderraouf", "K.abderraouf", "", ""],                 ["Akram", "H.akram", "", ""],
            ];
            exportToCSV(data, "disabled_users.csv");
        }
        
        function exportPasswordNeverExpiresUsers() {
            const data = [
                ["Name", "SamAccountName", "Last Logon", "Password Last Set", "Enabled"],
                ["Guest", "Guest", "", "", "False"],                 ["Hamid Cherifi", "hamid.cherifi", "", "06/17/2025 08:02:51", "True"],                 ["admin utilisateur", "adminu", "", "08/16/2025 15:58:55", "True"],
            ];
            exportToCSV(data, "password_never_expires_users.csv");
        }
        
        function exportInactiveUsers() {
            const data = [
                ["Name", "SamAccountName", "Last Logon", "Enabled"],

            ];
            exportToCSV(data, "inactive_users_90days.csv");
        }
        
        function exportLockedOutUsers() {
            const data = [
                ["Name", "SamAccountName", "Account Lockout Time", "Last Logon"],

            ];
            exportToCSV(data, "locked_out_users.csv");
        }
        
        function exportEnabledComputers() {
            const data = [
                ["Name", "Operating System", "Last Logon"],
                ["adVM", "Windows Server 2019 Datacenter", "09/09/2025 21:48:42"],                 ["DEMOC", "Windows 11 Enterprise N", "08/16/2025 15:23:06"],                 ["advm2", "Windows Server 2019 Datacenter", "09/15/2025 11:52:29"],
            ];
            exportToCSV(data, "enabled_computers.csv");
        }
        
        function exportDisabledComputers() {
            const data = [
                ["Name", "Operating System", "Last Logon"],

            ];
            exportToCSV(data, "disabled_computers.csv");
        }
        
        function exportInactiveComputers() {
            const data = [
                ["Name", "Operating System", "Last Logon"],

            ];
            exportToCSV(data, "inactive_computers_90days.csv");
        }
        
        function exportWindowsServers() {
            const data = [
                ["Name", "Operating System", "Last Logon", "Enabled"],
                ["adVM", "Windows Server 2019 Datacenter", "09/09/2025 21:48:42", "True"],                 ["advm2", "Windows Server 2019 Datacenter", "09/15/2025 11:52:29", "True"],
            ];
            exportToCSV(data, "windows_servers.csv");
        }
        
        function exportWindowsWorkstations() {
            const data = [
                ["Name", "Operating System", "Last Logon", "Enabled"],
                ["DEMOC", "Windows 11 Enterprise N", "08/16/2025 15:23:06", "True"],
            ];
            exportToCSV(data, "windows_workstations.csv");
        }
        
        function exportTotalUsers() {
            const data = [
                ["Name", "SamAccountName", "Enabled", "Last Logon", "Password Last Set", "Password Never Expires", "Locked Out"],
                ["adminuser", "adminuser", "True", "09/15/2025 21:38:00", "09/11/2025 22:28:04", "False", ""],                 ["Guest", "Guest", "False", "", "", "True", ""],                 ["krbtgt", "krbtgt", "False", "", "06/16/2025 21:22:03", "False", ""],                 ["Hamid Cherifi", "hamid.cherifi", "True", "", "06/17/2025 08:02:51", "True", ""],                 ["admin utilisateur", "adminu", "True", "", "08/16/2025 15:58:55", "True", ""],                 ["test user", "tuser", "False", "", "08/16/2025 17:02:18", "False", ""],                 ["test user20", "tuser20", "True", "", "08/16/2025 17:04:53", "False", ""],                 ["test user2", "tuser2", "True", "", "08/16/2025 17:05:47", "False", ""],                 ["Mohamed", "zmohamed", "True", "", "08/17/2025 12:52:25", "False", ""],                 ["zmohamed", "m.mohamed", "True", "", "08/17/2025 13:19:47", "False", ""],                 ["Abderraouf", "K.abderraouf", "False", "", "", "False", ""],                 ["Akram", "H.akram", "False", "", "", "False", ""],
            ];
            exportToCSV(data, "total_users.csv");
        }
        
        function exportTotalComputers() {
            const data = [
                ["Name", "Operating System", "Enabled", "Last Logon", "Type"],
                ["adVM", "Windows Server 2019 Datacenter", "True", "09/09/2025 21:48:42", "Server"],                 ["DEMOC", "Windows 11 Enterprise N", "True", "08/16/2025 15:23:06", "Workstation"],                 ["advm2", "Windows Server 2019 Datacenter", "True", "09/15/2025 11:52:29", "Server"],
            ];
            exportToCSV(data, "total_computers.csv");
        }
    </script>
</head>
<body class="bg-light">
    <div class="container-fluid">
        <!-- Header Section -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card shadow-sm border-0">
                    <div class="card-header bg-primary text-white">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h1 class="h3 mb-0">
                                    <i class="bi bi-shield-check me-2"></i>
                                    Active Directory Audit Report
                                </h1>
                            </div>
                            <div class="col-md-4 text-md-end">
                                <small class="opacity-75">
                                    <i class="bi bi-calendar3 me-1"></i>
                                    Generated: 2025-09-19 19:19:47
                                </small>
                            </div>
                        </div>
                    </div>
                    <div class="card-body bg-gradient">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="d-flex align-items-center mb-2">
                                    <i class="bi bi-building text-primary me-2"></i>
                                    <strong class="me-2">Domain:</strong>
                                    <span class="badge bg-light text-dark">demo.local</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="d-flex align-items-center mb-2">
                                    <i class="bi bi-diagram-3 text-success me-2"></i>
                                    <strong class="me-2">Forest:</strong>
                                    <span class="badge bg-light text-dark">demo.local</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stats Dashboard Section -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card shadow-sm border-0">
                    <div class="card-header bg-light">
                        <h4 class="mb-0">
                            <i class="bi bi-graph-up text-primary me-2"></i>
                            Audit Overview & Key Metrics
                        </h4>
                    </div>
                    <div class="card-body">
                        <div class="row g-3">
                            <!-- Domain Controllers Stats -->
                            <div class="col-xl-3 col-lg-6 col-md-6">
                                <div class="card bg-primary bg-gradient text-white h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <h6 class="text-uppercase text-white-50 small">Domain Controllers</h6>
                                                <h2 class="mb-0" id="dcCount">2</h2>
                                                <span class="small">Total DCs Found</span>
                                            </div>
                                            <div class="align-self-center">
                                                <i class="bi bi-server" style="font-size: 2rem; opacity: 0.8;"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- User Accounts Stats -->
                            <div class="col-xl-3 col-lg-6 col-md-6">
                                <div class="card bg-success bg-gradient text-white h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <h6 class="text-uppercase text-white-50 small">User Accounts</h6>
                                                <h2 class="mb-0" id="userCount">12</h2>
                                                <span class="small">Active Users</span>
                                            </div>
                                            <div class="align-self-center">
                                                <i class="bi bi-people" style="font-size: 2rem; opacity: 0.8;"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Computer Accounts Stats -->
                            <div class="col-xl-3 col-lg-6 col-md-6">
                                <div class="card bg-info bg-gradient text-white h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <h6 class="text-uppercase text-white-50 small">Computer Accounts</h6>
                                                <h2 class="mb-0" id="computerCount">3</h2>
                                                <span class="small">Total Computers</span>
                                            </div>
                                            <div class="align-self-center">
                                                <i class="bi bi-laptop" style="font-size: 2rem; opacity: 0.8;"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Security Events Stats -->
                            <div class="col-xl-3 col-lg-6 col-md-6">
                                <div class="card bg-warning bg-gradient text-white h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <h6 class="text-uppercase text-white-50 small">Security Events</h6>
                                                <h2 class="mb-0" id="securityEvents">0</h2>
                                                <span class="small">Critical Events</span>
                                            </div>
                                            <div class="align-self-center">
                                                <i class="bi bi-shield-exclamation" style="font-size: 2rem; opacity: 0.8;"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    <!-- ============================================ -->
    <!-- 🏗️ SECTION 1: INFRASTRUCTURE & FOUNDATION -->
    <!-- ============================================ -->

    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-header bg-secondary text-white">
                    <h4 class="mb-0">
                        <i class="bi bi-diagram-3 me-2"></i>
                        Infrastructure & Foundation
                    </h4>
                    <small class="text-white-50">Core Active Directory infrastructure components including domain controllers, replication, DNS, and forest structure.</small>
                </div>
                <div class="card-body">                    <div class="row">
                        <div class="col-12">

    <div class="section">
        <h2>🖥️ Domain Controllers Analysis</h2><h3>Domain Controllers Summary</h3><table><thead><tr><th>DC Name</th><th>Domain</th><th>OS Version</th><th>IPv4</th><th>Global Catalog</th><th>Read Only</th></tr></thead><tbody><tr><td><strong>adVM.demo.local</strong></td><td>demo.local</td><td>Windows Server 2019 Datacenter</td><td>10.0.0.4</td><td><span class="badge badge-success">Yes</span></td><td><span class="badge badge-success">No</span></td></tr><tr><td><strong>advm2.demo.local</strong></td><td>demo.local</td><td>Windows Server 2019 Datacenter</td><td>10.0.0.6</td><td><span class="badge badge-success">Yes</span></td><td><span class="badge badge-success">No</span></td></tr></tbody></table><h3>Detailed Health Report</h3><table><thead><tr><th>DC Name</th><th>Domain</th><th>Uptime</th><th>Time Sync</th><th>Disk Free %</th><th>Disk Free GB</th><th>SYSVOL/Netlogon</th><th>Services</th><th>DCDiag Summary</th></tr></thead><tbody><tr><td><strong>adVM.demo.local</strong></td><td>demo.local</td><td>9 days, 21h 06m</td><td>0s</td><td>82.47%</td><td>104.33 GB</td><td>Missing</td><td>DNS✓ NTDS✓ NETLOGON✓ KDC✓ W32Time✓</td><td>1/8</td></tr><tr><td><strong>advm2.demo.local</strong></td><td>demo.local</td><td>Unreachable</td><td>Unreachable</td><td>Unreachable%</td><td>Unreachable GB</td><td>Unreachable</td><td>DNS⚠ NTDS⚠ NETLOGON⚠ KDC⚠ W32Time⚠</td><td>0/1</td></tr></table><h3>Detailed DCDiag Test Results</h3><div class='controls-panel'><strong>DCDiag Controls:</strong> <button class='control-btn' onclick='expandAllDCDiag()'>Expand All</button><button class='control-btn' onclick='collapseAllDCDiag()'>Collapse All</button><button class='control-btn' onclick='showFailedDCDiagOnly()'>Show Failed Only</button><button class='control-btn' onclick='showAllDCDiag()'>Show All</button></div><div class='group-item'><span class='group-toggle' onclick='toggleDCDiag("adVM_demo_local")'><strong>adVM.demo.local</strong></span><div class='group-children' id='dcdiag-adVM_demo_local'><table><thead><tr><th>Test Name</th><th>Result</th></tr></thead><tbody><tr class=''><td>Count</td><td>169</td></tr><tr class=''><td>Length</td><td>169</td></tr><tr class=''><td>LongLength</td><td>169</td></tr><tr class=''><td>Rank</td><td>1</td></tr><tr class=''><td>SyncRoot</td><td> Directory Server Diagnosis   Performing initial setup:     Trying to find home server...     Home Server = adVM     * Identified AD Forest.     Done gathering initial info.   Doing initial required tests         Testing server: Default-First-Site-Name\adVM        Starting test: Connectivity           ......................... adVM passed test Connectivity    Doing primary tests         Testing server: Default-First-Site-Name\adVM        Starting test: Advertising           ......................... adVM passed test Advertising        Starting test: FrsEvent           ......................... adVM passed test FrsEvent        Starting test: DFSREvent           There are warning or error events within the last 24 hours after the           SYSVOL has been shared.  Failing SYSVOL replication problems may cause           Group Policy problems.           ......................... adVM failed test DFSREvent        Starting test: SysVolCheck           ......................... adVM passed test SysVolCheck        Starting test: KccEvent           ......................... adVM passed test KccEvent        Starting test: KnowsOfRoleHolders           ......................... adVM passed test KnowsOfRoleHolders        Starting test: MachineAccount           ......................... adVM passed test MachineAccount        Starting test: NCSecDesc           ......................... adVM passed test NCSecDesc        Starting test: NetLogons           ......................... adVM passed test NetLogons        Starting test: ObjectsReplicated           ......................... adVM passed test ObjectsReplicated        Starting test: Replications           [ADVM2] DsBindWithSpnEx() failed with error 1722,           The RPC server is unavailable..          ......................... adVM failed test Replications        Starting test: RidManager           ......................... adVM passed test RidManager        Starting test: Services           ......................... adVM passed test Services        Starting test: SystemLog           ......................... adVM passed test SystemLog        Starting test: VerifyReferences           ......................... adVM passed test VerifyReferences             Running partition tests on : ForestDnsZones        Starting test: CheckSDRefDom           ......................... ForestDnsZones passed test CheckSDRefDom        Starting test: CrossRefValidation           ......................... ForestDnsZones passed test           CrossRefValidation         Running partition tests on : DomainDnsZones        Starting test: CheckSDRefDom           ......................... DomainDnsZones passed test CheckSDRefDom        Starting test: CrossRefValidation           ......................... DomainDnsZones passed test           CrossRefValidation         Running partition tests on : Schema        Starting test: CheckSDRefDom           ......................... Schema passed test CheckSDRefDom        Starting test: CrossRefValidation           ......................... Schema passed test CrossRefValidation         Running partition tests on : Configuration        Starting test: CheckSDRefDom           ......................... Configuration passed test CheckSDRefDom        Starting test: CrossRefValidation           ......................... Configuration passed test CrossRefValidation         Running partition tests on : demo        Starting test: CheckSDRefDom           ......................... demo passed test CheckSDRefDom        Starting test: CrossRefValidation           ......................... demo passed test CrossRefValidation         Running enterprise tests on : demo.local        Starting test: LocatorCheck           ......................... demo.local passed test LocatorCheck        Starting test: Intersite           ......................... demo.local passed test Intersite </td></tr><tr class=''><td>IsReadOnly</td><td>False</td></tr><tr class='error'><td>IsFixedSize</td><td>True</td></tr><tr class=''><td>IsSynchronized</td><td>False</td></tr></tbody></table></div></div><div class='group-item'><span class='group-toggle' onclick='toggleDCDiag("advm2_demo_local")'><strong>advm2.demo.local</strong></span><div class='group-children' id='dcdiag-advm2_demo_local'><table><thead><tr><th>Test Name</th><th>Result</th></tr></thead><tbody><tr class=''><td>Length</td><td>31</td></tr></tbody></table></div></div>    <script>
    function toggleDCDiag(dcId) {
        var toggle = event.target.closest('.group-toggle');
        var children = document.getElementById('dcdiag-' + dcId);
        
        if (children) {
            if (children.classList.contains('show')) {
                children.classList.remove('show');
                toggle.classList.remove('expanded');
            } else {
                children.classList.add('show');
                toggle.classList.add('expanded');
            }
        }
    }

    function expandAllDCDiag() {
        document.querySelectorAll('.group-toggle').forEach(t => t.classList.add('expanded'));
        document.querySelectorAll('[id^="dcdiag-"]').forEach(d => d.classList.add('show'));
    }

    function collapseAllDCDiag() {
        document.querySelectorAll('.group-toggle').forEach(t => t.classList.remove('expanded'));
        document.querySelectorAll('[id^="dcdiag-"]').forEach(d => d.classList.remove('show'));
    }

    function showFailedDCDiagOnly() {
        document.querySelectorAll('.group-item').forEach(item => {
            const anyFail = item.querySelector('tr.error') !== null;
            item.style.display = anyFail ? 'block' : 'none';
        });
    }

    function showAllDCDiag() {
        document.querySelectorAll('.group-item').forEach(item => {
            item.style.display = 'block';
        });
    }
    </script>    </div>

    <div class="section">
        <h2>📊 DC Performance Metrics</h2>
        <table>
            <tr>
                <th>Domain Controller</th>
                <th>CPU Usage</th>
                <th>Memory Usage</th>
                <th>AD Database Size</th>
                <th>Log File Size</th>
                <th>LDAP Connections</th>
            </tr>                <tr>
                    <td><strong>adVM.demo.local</strong></td>
                    <td>16%</td>
                    <td>38.2% (3.06 GB / 8 GB)</td>
                    <td>Access Denied</td>
                    <td>Access Denied</td>
                    <td>0</td>
                </tr>                <tr>
                    <td><strong>advm2.demo.local</strong></td>
                    <td>0%</td>
                    <td>N/A</td>
                    <td>Access Denied</td>
                    <td>Access Denied</td>
                    <td>0</td>
                </tr>        </table>
    </div>


    <div class="section">
        <h2>🔄 Replication Health Assessment</h2><div class='warning'>Replication issues detected:</div><table><thead><tr><th>Source DC</th><th>Destination DC</th><th>Naming Context</th><th>Failures</th><th>Last Success</th></tr></thead><tbody><tr><td>advm2.demo.local</td><td></td><td></td><td></td><td></td></tr></tbody></table></div>
<div class="section">
    <h2>🌐 DNS Configuration Testing</h2><h3>📊 DNS Status Overview</h3><div class='table-responsive'><table class='dns-table'><thead><tr><th>Domain Controller</th><th>Connectivity</th><th>DNS Server IP</th><th>DCDiag DNS</th><th>Domain Resolution</th><th>Reverse Lookup</th><th>Scavenging</th><th>Issues Found</th></tr></thead><tbody><tr class='success'><td><strong>adVM.demo.local</strong></td><td><span class='status success'>Online</span></td><td>Unknown</td><td><span class='status success'>Passed</span></td><td>Failed</td><td>Failed</td><td>Unknown</td><td><span class='status error'>34 issues</span></td></tr><tr class='warning'><td><strong>advm2.demo.local</strong></td><td><span class='status warning'>Port 53 blocked</span></td><td>Unknown</td><td><span class='status warning'>Unknown</span></td><td>Unknown</td><td>Unknown</td><td>Unknown</td><td><span class='status warning'>1 issues</span></td></tr></tbody></table></div><h3>🔍 Detailed DNS Issues (35 total)</h3><h4>Issues on adVM.demo.local (34 issues)</h4><h5 class='info'>Obsolete Issues (34)</h5><div style='max-height: 300px; overflow-y: auto; border: 1px solid #e2e8f0; padding: 12px; border-radius: 8px; background: #fafafa;'><table><thead><tr><th>Issue</th><th>Details</th><th>Zone</th></tr></thead><tbody><tr class='info'><td>advm.demo.local. [NS] @</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [CNAME] 66927140-b7d6-46b8-938e-d6b659d3c018</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [A] advm</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [SRV] _kerberos._tcp.Default-First-Site-Name._sites.dc</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.Default-First-Site-Name._sites.dc</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [SRV] _kerberos._tcp.dc</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.dc</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.63dbe2d7-a489-4b0e-8ab7-7b080e92ace7.domains</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [A] gc</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.Default-First-Site-Name._sites.gc</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.gc</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.pdc</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td>advm.demo.local. [NS] @</td><td>Found in zone 0.in-addr.arpa</td><td>0.in-addr.arpa</td></tr><tr class='info'><td>advm.demo.local. [NS] @</td><td>Found in zone 127.in-addr.arpa</td><td>127.in-addr.arpa</td></tr><tr class='info'><td>advm.demo.local. [NS] @</td><td>Found in zone 255.in-addr.arpa</td><td>255.in-addr.arpa</td></tr><tr class='info'><td> [A] @</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td>advm.demo.local. [NS] @</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _gc._tcp.Default-First-Site-Name._sites</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _kerberos._tcp.Default-First-Site-Name._sites</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.Default-First-Site-Name._sites</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _gc._tcp</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _kerberos._tcp</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _kpasswd._tcp</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _kerberos._udp</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _kpasswd._udp</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [A] advm</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [A] DomainDnsZones</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.Default-First-Site-Name._sites.DomainDnsZones</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.DomainDnsZones</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [A] ForestDnsZones</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.Default-First-Site-Name._sites.ForestDnsZones</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.ForestDnsZones</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td>advm.demo.local. [NS] @</td><td>Found in zone TrustAnchors</td><td>TrustAnchors</td></tr></tbody></table></div><h4>Issues on advm2.demo.local (1 issues)</h4><h5 class='error'>Connectivity Issues (1)</h5><table><thead><tr><th>Issue</th><th>Details</th></tr></thead><tbody><tr class='error'><td>Domain Controller is unreachable</td><td>Cannot perform DNS tests - Port 53 blocked</td></tr></tbody></table><div class='success'><h4>📈 DNS Health Summary</h4><div class='info-grid'><p><strong>Online Domain Controllers:</strong>  / 2</p><p><strong>Passed DCDiag DNS Tests:</strong>  /  (online DCs)</p><p><strong>Total DNS Issues Found:</strong> 35</p><p><strong>Obsolete DNS Records:</strong> 34</p></div></div>    </div>

    <div class="section">
        <h2>👑 FSMO Roles Verification</h2><table><thead><tr><th>Role</th><th>Server</th><th>Scope</th><th>Status</th></tr></thead><tbody><tr class='status-online'><td>Schema Master</td><td>adVM.demo.local</td><td>Forest</td><td>Online</td></tr><tr class='status-online'><td>Domain Naming Master</td><td>adVM.demo.local</td><td>Forest</td><td>Online</td></tr><tr class='status-online'><td>RID Master</td><td>adVM.demo.local</td><td>demo.local</td><td>Online</td></tr><tr class='status-online'><td>PDC Emulator</td><td>adVM.demo.local</td><td>demo.local</td><td>Online</td></tr><tr class='status-online'><td>Infrastructure Master</td><td>adVM.demo.local</td><td>demo.local</td><td>Online</td></tr></tbody></table><div class='fsmo-summary status-online'><strong>FSMO Health Summary:</strong> 5/5 roles online (100%)</div>    </div>

    <div class="section">
        <h2>🤝 Trust Relationships Analysis</h2><div class='success'>No external trusts configured</div>    </div>

    <div class="section">
        <h2>🏢 AD Sites & Services Audit</h2><h3>Sites</h3><table><thead><tr><th>Site Name</th><th>Description</th><th>Domain Controllers</th><th>Subnets</th></tr></thead><tbody><tr><td>Default-First-Site-Name</td><td></td><td>2</td><td></td></tr></tbody></table><h3>Site Links</h3><table><thead><tr><th>Link Name</th><th>Cost</th><th>Replication Frequency (min)</th><th>Sites</th></tr></thead><tbody><tr><td>DEFAULTIPSITELINK</td><td>100</td><td>180</td><td>CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=demo,DC=local</td></tr></tbody></table>    </div>

    <div class="section">
        <h2>📋 Group Policy Security Analysis</h2>        <div class="subsection">
            <h3>🎯 Security Overview</h3>
            <div class="row">
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-primary">4</h5>
                            <p class="card-text">Total GPOs</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-success">3</h5>
                            <p class="card-text">Linked GPOs</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-success">0</h5>
                            <p class="card-text">High Risk GPOs</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-success">0</h5>
                            <p class="card-text">Orphaned GPOs</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>        <div class="subsection">
            <h3>⚠️ Security Issues Found</h3>
            <div class="alert alert-warning">
                <strong>2 unique security issues detected across all GPOs:</strong>
                <ul class="mt-2"><li>Weak password length requirement (&lt; 14 characters)</li><li>Weak account lockout threshold</li>                </ul>
            </div>
        </div>        <div class="subsection">
            <h3>💡 Security Recommendations</h3>
            <div class="alert alert-info">
                <ul class="mb-0"><li>Set minimum password length to 14+ characters</li><li>Set account lockout threshold to 3-5 failed attempts</li>                </ul>
            </div>
        </div>        <div class="subsection">
            <h3>⚡ GPO Conflict Analysis</h3>
            <div class="row">
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-success">0</h5>
                            <p class="card-text">Total Conflicts</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-success">0</h5>
                            <p class="card-text">Critical Conflicts</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-success">0</h5>
                            <p class="card-text">Warning Conflicts</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-success">0</h5>
                            <p class="card-text">Affected OUs</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>        <div class="subsection">
            <h3>📊 Detailed GPO Analysis</h3>
            <div class="table-responsive">
                <table class="table table-striped table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>GPO Name</th>
                            <th>Status</th>
                            <th>Links</th>
                            <th>Last Modified</th>
                            <th>Issues</th>
                        </tr>
                    </thead>
                    <tbody>                        <tr class="table-warning">
                            <td><strong>Default Domain Policy</strong></td>
                            <td>⚠️ Medium Risk</td>
                            <td>
                                <span class="badge bg-success">5</span>
                                
                            </td>
                            <td class="text-muted">94 days ago</td>
                            <td><span class='badge bg-danger'>2</span></td>
                        </tr>                        <tr class="table-light">
                            <td colspan="5">
                                <div class="ms-3"><small><strong>Security Issues:</strong></small><ul class='small mb-1'><li class='text-danger'>Weak password length requirement (&lt; 14 characters)</li><li class='text-danger'>Weak account lockout threshold</li></ul>                                </div>
                            </td>
                        </tr>                        <tr class="table-success">
                            <td><strong>New Group Policy Object</strong></td>
                            <td>✅ Healthy</td>
                            <td>
                                <span class="badge bg-success">5</span>
                                
                            </td>
                            <td class="text-muted">87 days ago</td>
                            <td><span class='badge bg-success'>0</span></td>
                        </tr>                        <tr class="table-success">
                            <td><strong>Default Domain Controllers Policy</strong></td>
                            <td>✅ Healthy</td>
                            <td>
                                <span class="badge bg-success">5</span>
                                
                            </td>
                            <td class="text-muted">29 days ago</td>
                            <td><span class='badge bg-success'>0</span></td>
                        </tr>                        <tr class="table-success">
                            <td><strong>test gpo not linked</strong></td>
                            <td>✅ Healthy</td>
                            <td>
                                <span class="badge bg-secondary">0</span>
                                <span class="badge bg-warning">Unlinked</span>
                            </td>
                            <td class="text-muted">44 days ago</td>
                            <td><span class='badge bg-success'>0</span></td>
                        </tr>                    </tbody>
                </table>
            </div>
        </div>        <div class="subsection">
            <h3>🔗 GPO Link Analysis</h3>
            <div class="table-responsive">
                <table class="table table-sm">
                    <thead class="table-secondary">
                        <tr>
                            <th>GPO Name</th>
                            <th>Linked To</th>
                            <th>Link Status</th>
                            <th>Enforced</th>
                            <th>Order</th>
                        </tr>
                    </thead>
                    <tbody>                        <tr>
                            <td>Default Domain Policy</td>
                            <td>🏢 Domain Root</td>
                            <td><span class='badge bg-success'>Enabled</span></td>
                            <td><span class='badge bg-light text-dark'>Normal</span></td>
                            <td><span class='badge bg-info'>1</span></td>
                        </tr>                        <tr>
                            <td>Default Domain Controllers Policy</td>
                            <td>📁 Domain Controllers</td>
                            <td><span class='badge bg-success'>Enabled</span></td>
                            <td><span class='badge bg-light text-dark'>Normal</span></td>
                            <td><span class='badge bg-info'>1</span></td>
                        </tr>                        <tr>
                            <td>New Group Policy Object</td>
                            <td>📁 company</td>
                            <td><span class='badge bg-success'>Enabled</span></td>
                            <td><span class='badge bg-light text-dark'>Normal</span></td>
                            <td><span class='badge bg-info'>1</span></td>
                        </tr>                    </tbody>
                </table>
            </div>
        </div>    </div>

    <div class="section">
        <h2>🏗️ Schema Architecture</h2><div class='error'>Schema Analysis Error: Method invocation failed because [Microsoft.ActiveDirectory.Management.ADPropertyValueCollection] does not contain a method named 'op_Addition'.</div>    </div>

    <!-- ============================================ -->
    <!-- 👥 SECTION 2: IDENTITY & ACCESS MANAGEMENT -->
    <!-- ============================================ -->


    <div class="section">
        <h2>👥 User & Computer Accounts Analysis</h2>        <h3>👥 User Account Statistics</h3>
        <div class="metric">
            <button class="export-btn" onclick="exportTotalUsers()" title="Export All Users">📥</button>
            <div class="number">12</div>
            <div class="label">Total Users</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportEnabledUsers()" title="Export Enabled Users">📥</button>
            <div class="number">7</div>
            <div class="label">Enabled</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportDisabledUsers()" title="Export Disabled Users">📥</button>
            <div class="number">5</div>
            <div class="label">Disabled</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportPasswordNeverExpiresUsers()" title="Export Users with Non-Expiring Passwords">📥</button>
            <div class="number">3</div>
            <div class="label">Never Expires</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportInactiveUsers()" title="Export Inactive Users">📥</button>
            <div class="number">0</div>
            <div class="label">Inactive 90d</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportLockedOutUsers()" title="Export Locked Out Users">📥</button>
            <div class="number">0</div>
            <div class="label">Locked Out</div>
        </div>
        
        <h3>💻 Computer Account Statistics</h3>
        <div class="metric">
            <button class="export-btn" onclick="exportTotalComputers()" title="Export All Computers">📥</button>
            <div class="number">3</div>
            <div class="label">Total Computers</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportEnabledComputers()" title="Export Enabled Computers">📥</button>
            <div class="number">3</div>
            <div class="label">Enabled</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportDisabledComputers()" title="Export Disabled Computers">📥</button>
            <div class="number">0</div>
            <div class="label">Disabled</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportWindowsServers()" title="Export Windows Servers">📥</button>
            <div class="number">2</div>
            <div class="label">Servers</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportWindowsWorkstations()" title="Export Windows Workstations">📥</button>
            <div class="number">1</div>
            <div class="label">Workstations</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportInactiveComputers()" title="Export Inactive Computers">📥</button>
            <div class="number">0</div>
            <div class="label">Inactive 90d</div>
        </div>    </div>

    <!-- ============================================ -->
    <!-- 🔒 SECTION 3: SECURITY ANALYSIS -->
    <!-- ============================================ -->


    <div class="section">
        <h2>🔒 Security Analysis & Risk Assessment</h2><div class='warning'><strong>Security Findings:</strong><ul><li>Weak minimum password length in default policy: 7</li><li>No Password Settings Objects (PSOs) configured - consider implementing for privileged accounts</li><li>KRBTGT account password is 94 days old - consider resetting soon</li><li>Active Directory Recycle Bin is not enabled - consider enabling for accidental deletion protection</li><li>2 enabled accounts with non-expiring passwords</li></ul></div><h3>Password Policies</h3><h4>Default Domain Password Policy</h4><table><thead><tr><th>Setting</th><th>Value</th></tr></thead><tbody><tr><td>Minimum Password Length</td><td>7</td></tr><tr><td>Password Complexity</td><td>True</td></tr><tr><td>Maximum Password Age</td><td>42.00:00:00</td></tr><tr><td>Minimum Password Age</td><td>1.00:00:00</td></tr><tr><td>Password History Count</td><td>24</td></tr><tr><td>Lockout Threshold</td><td>0</td></tr></tbody></table><div class='warning'><strong>No Password Settings Objects (PSOs) configured</strong><br/>Consider implementing Fine-Grained Password Policies for privileged accounts.</div><h3>Privileged Group Membership</h3><div class='metric'><div class='number'>1</div><div class='label'>Domain Admins</div></div><div class='metric'><div class='number'>1</div><div class='label'>Enterprise Admins</div></div><div class='metric'><div class='number'>1</div><div class='label'>Schema Admins</div></div><h3>🔑 KRBTGT Account Status</h3><div class='warning'><h4>KRBTGT Password Information</h4><div class='info-grid'><p><strong>Password Last Set:</strong> 06/16/2025 21:22:03</p><p><strong>Password Age:</strong> 94 days</p><p><strong>Status:</strong> Warning</p></div><p><strong>⚠️ Recommendation:</strong> Consider resetting the KRBTGT password soon. Best practice is to reset every 90-180 days.</p></div><h3>🗑️ Active Directory Recycle Bin</h3><div class='warning'><h4>⚠️ AD Recycle Bin is Disabled</h4><p><strong>Recommendation:</strong> Enable the Active Directory Recycle Bin feature to protect against accidental object deletions.</p><p>This feature allows recovery of deleted AD objects without requiring a system state restore.</p></div>    </div>

    <div class="section">
        <h2>🏗️ OU Hierarchy Mapping</h2><div class='ou-tree' id='ou-tree'><div class='ou-item ou-level-0'><span class='ou-toggle' onclick='toggleOU("OU_company_DC_demo_DC_local")'><strong>company</strong><span class='ou-stats'>(Users: 0, Computers: 0, Groups: 0)</span></span><div class='ou-children' id='children-OU_company_DC_demo_DC_local'><div class='ou-item ou-level-1'><span class='ou-item'>&nbsp;&nbsp;&nbsp;<strong>DRH</strong><span class='ou-stats'>(Users: 0, Computers: 0, Groups: 2)</span></span></div><div class='ou-item ou-level-1'><span class='ou-toggle' onclick='toggleOU("OU_DSI_OU_company_DC_demo_DC_local")'><strong>DSI</strong><span class='ou-stats'>(Users: 0, Computers: 0, Groups: 0)</span></span><div class='ou-children' id='children-OU_DSI_OU_company_DC_demo_DC_local'><div class='ou-item ou-level-2'><span class='ou-item'>&nbsp;&nbsp;&nbsp;<strong>Computers</strong><span class='ou-stats'>(Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='ou-item ou-level-2'><span class='ou-item'>&nbsp;&nbsp;&nbsp;<strong>users</strong><span class='ou-stats'>(Users: 0, Computers: 0, Groups: 0)</span></span></div></div></div></div></div><div class='ou-item ou-level-0'><span class='ou-item'>&nbsp;&nbsp;&nbsp;<strong>Domain Controllers</strong><span class='ou-stats'>(Users: 0, Computers: 2, Groups: 0)</span></span></div></div>    <script>
    function toggleOU(ouId) {
        var toggle = event.target;
        var children = document.getElementById('children-' + ouId);
        
        if (children) {
            if (children.classList.contains('show')) {
                children.classList.remove('show');
                toggle.classList.remove('expanded');
            } else {
                children.classList.add('show');
                toggle.classList.add('expanded');
            }
        }
    }
    </script>    </div>

    <div class="section">
        <h2>🔍 Security Events & Error Analysis</h2><div class='success'><h4>✅ No Critical Security Events Found</h4><p>No critical security events were detected in the last 7 days, or the event log analysis encountered issues.</p></div>    </div>

    <div class="section">
        <h2>👥 Security Group Nesting Analysis</h2><div class='metric'><div class='number'>51</div><div class='label'>Total Groups</div></div><div class='metric'><div class='number'>2</div><div class='label'>With Nested Groups</div></div><div class='metric'><div class='number'>0</div><div class='label'>Deep Nesting (3+)</div></div><div class='metric'><div class='number'>0</div><div class='label'>Large Groups (100+)</div></div><div class='metric'><div class='number'>38</div><div class='label'>Empty Groups</div></div><div class='controls-panel'><strong>View Controls:</strong> <button class='control-btn' onclick='expandAllGroups()'>Expand All</button><button class='control-btn' onclick='collapseAllGroups()'>Collapse All</button><button class='control-btn' onclick='showAllGroups()'>Show All</button></div><div class='group-tree' id='group-tree'><div class='group-item'><span class='group-toggle' onclick='toggleGroup("CN_Denied_RODC_Password_Replication_Group_CN_Users_DC_demo_DC_local")'><span class='group-name'>Denied RODC Password Replication Group</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 8 (Users: , Computers: 0, Groups: 7) | Nesting Depth: 1</span></span><div class='group-children' id='group-children-CN_Denied_RODC_Password_Replication_Group_CN_Users_DC_demo_DC_local'><div class='group-item'><span class='group-name'>↳ Read-only Domain Controllers</span></div><div class='group-item'><span class='group-name'>↳ Group Policy Creator Owners</span></div><div class='group-item'><span class='group-name'>↳ Domain Admins</span></div><div class='group-item'><span class='group-name'>↳ Cert Publishers</span></div><div class='group-item'><span class='group-name'>↳ Enterprise Admins</span></div><div class='group-item'><span class='group-name'>↳ Schema Admins</span></div><div class='group-item'><span class='group-name'>↳ Domain Controllers</span></div></div></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Users</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 3 (Users: 0, Computers: 0, Groups: )</span></span></div><div class='group-item'><span class='group-toggle' onclick='toggleGroup("CN_Administrators_CN_Builtin_DC_demo_DC_local")'><span class='group-name'>Administrators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 3 (Users: , Computers: 0, Groups: 2) | Nesting Depth: 1</span></span><div class='group-children' id='group-children-CN_Administrators_CN_Builtin_DC_demo_DC_local'><div class='group-item'><span class='group-name'>↳ Domain Admins</span></div><div class='group-item'><span class='group-name'>↳ Enterprise Admins</span></div></div></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Guests</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 2 (Users: , Computers: 0, Groups: )</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>test SGroup</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 1 (Users: 0, Computers: 0, Groups: )</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Pre-Windows 2000 Compatible Access</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 1 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>IIS_IUSRS</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 1 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>new test Sgroup</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 1 (Users: , Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Group Policy Creator Owners</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 1 (Users: , Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Schema Admins</span><span class='group-scope'>[Universal]</span><span class='group-stats'>Members: 1 (Users: , Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Domain Admins</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 1 (Users: , Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Enterprise Admins</span><span class='group-scope'>[Universal]</span><span class='group-stats'>Members: 1 (Users: , Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Windows Authorization Access Group</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 1 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>RDS Management Servers</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Enterprise Key Admins</span><span class='group-scope'>[Universal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Certificate Service DCOM Access</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Event Log Readers</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Cryptographic Operators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>RDS Endpoint Servers</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>RDS Remote Access Servers</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Incoming Forest Trust Builders</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Account Operators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Enterprise Read-only Domain Controllers</span><span class='group-scope'>[Universal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Terminal Server License Servers</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Server Operators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Access Control Assistance Operators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Hyper-V Administrators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Storage Replica Administrators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Remote Management Users</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Distributed COM Users</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Protected Users</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Cloneable Domain Controllers</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Key Admins</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Cert Publishers</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>DnsUpdateProxy</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Domain Controllers</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 2, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Domain Computers</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: , Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Domain Users</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 0 (Users: 11, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Read-only Domain Controllers</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Domain Guests</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 0 (Users: , Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>RAS and IAS Servers</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Remote Desktop Users</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Replicator</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Network Configuration Operators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Performance Log Users</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Performance Monitor Users</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>DnsAdmins</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Allowed RODC Password Replication Group</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Windows Admin Center CredSSP</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Backup Operators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Print Operators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div></div>    <script>
    function toggleGroup(groupId) {
        var toggle = event.target.closest('.group-toggle');
        var children = document.getElementById('group-children-' + groupId);
        
        if (children) {
            if (children.classList.contains('show')) {
                children.classList.remove('show');
                toggle.classList.remove('expanded');
            } else {
                children.classList.add('show');
                toggle.classList.add('expanded');
            }
        }
    }
    
    function expandAllGroups() {
        var allToggles = document.querySelectorAll('.group-toggle');
        var allChildren = document.querySelectorAll('.group-children');
        
        allToggles.forEach(function(toggle) {
            toggle.classList.add('expanded');
        });
        
        allChildren.forEach(function(child) {
            child.classList.add('show');
        });
    }
    
    function collapseAllGroups() {
        var allToggles = document.querySelectorAll('.group-toggle');
        var allChildren = document.querySelectorAll('.group-children');
        
        allToggles.forEach(function(toggle) {
            toggle.classList.remove('expanded');
        });
        
        allChildren.forEach(function(child) {
            child.classList.remove('show');
        });
    }
    
    function showAllGroups() {
        var allGroups = document.querySelectorAll('.group-item');

        allGroups.forEach(function(group) {
            group.style.display = 'block';
        });
    }
    </script>    </div>
    <div class="section">
        <h2>🔑 Group Managed Service Accounts (gMSA) Usage</h2><p><strong>Status:</strong> No gMSA accounts found.</p><div class='recommendation'>Recommendation: Consider implementing Group Managed Service Accounts (gMSA) for better security, automated password management, and Kerberos authentication.</div></div>
<div class='section'>
    <h2>🔐 Local Administrator Password Solution (LAPS) Audit</h2><p>No LAPS data found or unable to retrieve.</p>    </div>

    <div class='section'>
        <h2>🔐 Protocol Security Analysis (LLMNR, SMB, TLS, NTLM)</h2><table>
        <tr>
            <th>Domain Controller</th>
            <th>SMBv1 Enabled</th>
            <th>SMBv2 Enabled</th>
            <th>SMBv3 Enabled</th>
            <th>LLMNR Disabled</th>
            <th>TLS 1.0</th>
            <th>TLS 1.1</th>
            <th>TLS 1.2</th>
            <th>TLS 1.3</th>
            <th>NTLM Audit</th>
        </tr><tr class=''>
            <td></td>
            <td>Error</td>
            <td>Error</td>
            <td>Error</td>
            <td>Unknown</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>Error</td>
        </tr><tr class=''>
            <td></td>
            <td>Error</td>
            <td>Error</td>
            <td>Error</td>
            <td>Unknown</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>Error</td>
        </tr></table>        <h3>Protocol Security Recommendations</h3>
        <ul>
            <li><strong>SMBv1:</strong> Disable SMBv1 as it is insecure and vulnerable to exploits like WannaCry.</li>
            <li><strong>SMBv2/SMBv3:</strong> Keep these enabled but ensure security features (signing/encryption) are enforced where needed.</li>
            <li><strong>LLMNR:</strong> Disable to reduce exposure to name resolution poisoning attacks.</li>
            <li><strong>TLS Versions:</strong> Disable TLS 1.0 and 1.1; ensure TLS 1.2 and 1.3 are enabled for secure communications.</li>
            <li><strong>NTLM Audit:</strong> Configure auditing to monitor and reduce NTLM usage.</li>
        </ul></div>
<div class='section'>
    <h2>🛡 Protocols & Legacy Services Audit</h2><table>
        <tr><th>Setting</th><th>Status</th></tr><tr><td>TLS 1.0 Enabled (Client)</td><td>No</td></tr><tr><td>TLS 1.1 Enabled (Client)</td><td>No</td></tr><tr><td>SMBv1 Installed</td><td>No</td></tr><tr><td>LLMNR</td><td>Not Configured</td></tr><tr><td>TLS 1.0 Enabled (Server)</td><td>No</td></tr><tr><td>SMBv1 Enabled</td><td>No</td></tr><tr><td>NetBIOS</td><td>Default</td></tr><tr><td>TLS 1.1 Enabled (Server)</td><td>No</td></tr></table>    </div>
    <div class="section">
        <h2>🔍 Orphaned SIDs in Active Directory ACLs</h2><div class='metric'><div class='number'>1</div><div class='label'>Total Orphaned SIDs Found</div></div><h3>Top Objects with Most Orphaned SIDs</h3><table><tr><th>Distinguished Name</th><th>Orphaned SIDs Count</th></tr><tr><td>CN=test SGroup,OU=DRH,OU=company,DC=demo,DC=local</td><td>1</td></tr></table>    </div>

    <div class="section">
        <h2>👤 Privileged Account Monitoring</h2>
        <div class="subsection">
            <h3>Administrative Groups Analysis</h3>
            <table>
                <tr>
                    <th>Group Name</th>
                    <th>Member Count</th>
                    <th>Last Modified</th>
                    <th>Inactive Members</th>
                </tr>                <tr>
                    <td><strong>Domain Admins</strong></td>
                    <td></td>
                    <td></td>
                    <td>0</td>
                </tr>                <tr>
                    <td><strong>Enterprise Admins</strong></td>
                    <td></td>
                    <td></td>
                    <td>0</td>
                </tr>                <tr>
                    <td><strong>Schema Admins</strong></td>
                    <td></td>
                    <td></td>
                    <td>0</td>
                </tr>                <tr>
                    <td><strong>Administrators</strong></td>
                    <td>3</td>
                    <td></td>
                    <td>0</td>
                </tr>                <tr>
                    <td><strong>Backup Operators</strong></td>
                    <td>0</td>
                    <td></td>
                    <td>0</td>
                </tr>                <tr>
                    <td><strong>Print Operators</strong></td>
                    <td>0</td>
                    <td></td>
                    <td>0</td>
                </tr>                <tr>
                    <td><strong>Group Policy Creator Owners</strong></td>
                    <td></td>
                    <td></td>
                    <td>0</td>
                </tr>                <tr>
                    <td><strong>DNS Admins</strong></td>
                    <td>0</td>
                    <td></td>
                    <td>0</td>
                </tr>            </table>
        </div>

        <div class="subsection">
            <h3>Service Accounts with High Privileges</h3>
            <table>
                <tr>
                    <th>Account Name</th>
                    <th>Privileged Groups</th>
                    <th>Last Logon</th>
                    <th>Status</th>
                </tr>                <tr><td colspan="4">No privileged service accounts found</td></tr>            </table>
        </div>

        <div class="subsection">
            <h3>Inactive Privileged Accounts (90+ days)</h3>
            <table>
                <tr>
                    <th>User</th>
                    <th>Group</th>
                    <th>Last Logon</th>
                    <th>Days Inactive</th>
                </tr>                <tr><td colspan="4">No inactive privileged accounts found</td></tr>            </table>
        </div>
    </div>

    <div class="section">
        <h2>🛡️ AD Object Protection from Accidental Deletion</h2>        <h3>Protection Overview</h3>
        <div class="metric">
            <div class="number">22.7%</div>
            <div class="label">Overall Protection</div>
        </div>
        <div class="metric">
            <div class="number">5/6</div>
            <div class="label">Protected OUs</div>
        </div>
        <div class="metric">
            <div class="number">0/4</div>
            <div class="label">Protected Containers</div>
        </div>
        <div class="metric">
            <div class="number">0/2</div>
            <div class="label">Protected Critical Users</div>
        </div>
        <div class="metric">
            <div class="number">0/1</div>
            <div class="label">Protected Service Accounts</div>
        </div>
        <div class="metric">
            <div class="number">0/10</div>
            <div class="label">Protected Critical Groups</div>
        </div>
        
        <h3>Unprotected Objects (High Risk)</h3>        <div class="subsection">
            <h4>🚨 Unprotected Organizational Units (1)</h4>
            <table>
                <tr>
                    <th>OU Name</th>
                    <th>Distinguished Name</th>
                    <th>Description</th>
                </tr>                <tr>
                    <td><strong>Domain Controllers</strong></td>
                    <td>OU=Domain Controllers,DC=demo,DC=local</td>
                    <td>Default container for domain controllers</td>
                </tr></table></div>        <div class="subsection">
            <h4>🚨 Unprotected Critical Users (2)</h4>
            <table>
                <tr>
                    <th>User Name</th>
                    <th>Sam Account Name</th>
                    <th>Type</th>
                    <th>Service Principal Names</th>
                </tr>                <tr>
                    <td><strong>adminuser</strong></td>
                    <td>adminuser</td>
                    <td>Admin User</td>
                    <td>N/A</td>
                </tr>                <tr>
                    <td><strong>krbtgt</strong></td>
                    <td>krbtgt</td>
                    <td>Service Account</td>
                    <td>kadmin/changepw</td>
                </tr></table></div>        <div class="subsection">
            <h4>🚨 Unprotected Critical Groups (10)</h4>
            <table>
                <tr>
                    <th>Group Name</th>
                    <th>Group Scope</th>
                    <th>Distinguished Name</th>
                </tr>                <tr>
                    <td><strong>Domain Admins</strong></td>
                    <td>Global</td>
                    <td>CN=Domain Admins,CN=Users,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Enterprise Admins</strong></td>
                    <td>Universal</td>
                    <td>CN=Enterprise Admins,CN=Users,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Schema Admins</strong></td>
                    <td>Universal</td>
                    <td>CN=Schema Admins,CN=Users,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Administrators</strong></td>
                    <td>DomainLocal</td>
                    <td>CN=Administrators,CN=Builtin,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Account Operators</strong></td>
                    <td>DomainLocal</td>
                    <td>CN=Account Operators,CN=Builtin,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Server Operators</strong></td>
                    <td>DomainLocal</td>
                    <td>CN=Server Operators,CN=Builtin,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Backup Operators</strong></td>
                    <td>DomainLocal</td>
                    <td>CN=Backup Operators,CN=Builtin,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Print Operators</strong></td>
                    <td>DomainLocal</td>
                    <td>CN=Print Operators,CN=Builtin,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Group Policy Creator Owners</strong></td>
                    <td>Global</td>
                    <td>CN=Group Policy Creator Owners,CN=Users,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>DnsAdmins</strong></td>
                    <td>DomainLocal</td>
                    <td>CN=DnsAdmins,CN=Users,DC=demo,DC=local</td>
                </tr></table></div>        <div class="warning">
            <h4>⚠️ Unprotected Containers (4)</h4>
            <table>
                <tr>
                    <th>Container Name</th>
                    <th>Distinguished Name</th>
                </tr>                <tr>
                    <td><strong>Users</strong></td>
                    <td>CN=Users,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Computers</strong></td>
                    <td>CN=Computers,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>ForeignSecurityPrincipals</strong></td>
                    <td>CN=ForeignSecurityPrincipals,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Managed Service Accounts</strong></td>
                    <td>CN=Managed Service Accounts,DC=demo,DC=local</td>
                </tr></table></div><h3>Protection Recommendations</h3><div class='warning'><ul><li>Found 1 unprotected OUs. Consider enabling protection for critical organizational units.</li><li>Found 4 unprotected containers. Review and protect important containers from accidental deletion.</li><li>Found 2 unprotected critical users (admins/service accounts). Enable protection for privileged accounts.</li><li>Found 1 unprotected service accounts. Service accounts should always be protected from accidental deletion.</li><li>Found 10 unprotected critical groups. Administrative groups should be protected from accidental deletion.</li><li>Only 22.7% of critical AD objects are protected from accidental deletion. Aim for 100% protection of critical infrastructure objects.</li></ul></div>    </div>

    <!-- ============================================ -->
    <!-- 📊 SECTION 4: PERFORMANCE & HEALTH -->
    <!-- ============================================ -->

    <div class="section">
        <h2>📊 Performance & Health Monitoring</h2>
        <p>System performance metrics, database health, and operational monitoring data.</p>
    </div>






<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Active Directory Audit Report</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif; 
            margin: 0; padding: 20px 40px; 
            background: linear-gradient(to bottom right, #f8fafc 0%, #e2e8f0 100%);
            min-height: 100vh; 
            line-height: 1.5;
            font-size: 14px;
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 0 20px;
        }
        
        /* Header styling - cleaner and more professional */
        .header { 
            background: white;
            color: #1e293b; 
            padding: 40px 50px; 
            border-radius: 12px; 
            margin-bottom: 32px; 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            border-left: 4px solid #3b82f6;
        }
        .header h1 { margin: 0 0 20px 0; font-size: 2rem; font-weight: 700; color: #1e293b; }
        .header p { margin: 6px 0; color: #64748b; font-size: 0.875rem; }
        
        /* Section styling - reduced shadows and better spacing */
        .section { 
            background: white;
            margin: 24px 0; 
            padding: 32px 40px; 
            border-radius: 12px; 
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            border: 1px solid #e2e8f0;
        }
        .section h2 { 
            color: #1e293b; 
            border-bottom: 2px solid #e2e8f0; 
            padding-bottom: 16px; 
            margin-bottom: 28px; 
            font-weight: 600; 
            font-size: 1.375rem;
        }
        .section h3 {
            color: #334155;
            margin-top: 32px;
            margin-bottom: 20px;
            font-size: 1.125rem;
            font-weight: 600;
        }
        .section h4 {
            color: #374151;
            margin-top: 24px;
            margin-bottom: 16px;
            font-size: 1rem;
            font-weight: 600;
        }
        .section p {
            margin-bottom: 16px;
            color: #4b5563;
        }
        
        /* Alert boxes - softer colors and better contrast */
        .warning { 
            background: #fef3c7; 
            border: 1px solid #f59e0b; 
            color: #92400e;
            padding: 20px 24px; 
            border-radius: 8px; 
            margin: 24px 0;
            border-left: 4px solid #f59e0b;
            font-size: 0.875rem;
        }
        .error { 
            background: #fee2e2; 
            border: 1px solid #ef4444; 
            color: #991b1b;
            padding: 20px 24px; 
            border-radius: 8px; 
            margin: 24px 0;
            border-left: 4px solid #ef4444;
            font-size: 0.875rem;
        }
        .success {
            background: #dcfce7;
            border: 1px solid #22c55e;
            color: #166534;
            padding: 20px 24px;
            border-radius: 8px;
            margin: 24px 0;
            border-left: 4px solid #22c55e;
            font-size: 0.875rem;
        }
        .info {
            background: #e0f2fe;
            border: 1px solid #0284c7;
            color: #0c4a6e;
            padding: 20px 24px;
            border-radius: 8px;
            margin: 24px 0;
            border-left: 4px solid #0284c7;
            font-size: 0.875rem;
        }

        table { width: 100%; border-collapse: collapse; margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        th, td { border: none; padding: 12px 15px; text-align: left; }
        th { background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); color: white; font-weight: 500; }
        tr:nth-child(even) { background-color: rgba(52,152,219,0.05); }
        
        /* Status-specific row styling */
        .table .table-success {
            background-color: #d4edda !important;
            color: #155724;
        }
        
        .table .table-warning {
            background-color: #fff3cd !important;
            color: #856404;
        }
        
        .table .table-danger {
            background-color: #f8d7da !important;
            color: #721c24;
        }
        
        .table .table-info {
            background-color: #d1ecf1 !important;
            color: #0c5460;
        }

        /* Direct info class for table rows */
        tr.info {
            background-color: #e0f2fe !important;
            color: #0c4a6e;
        }

        tr.info td {
            background-color: #e0f2fe !important;
            color: #0c4a6e;
        }

        /* Info header styling */
        h5.info {
            color: #0c4a6e;
            background-color: #e0f2fe;
            padding: 8px 12px;
            border-radius: 4px;
            border-left: 3px solid #0284c7;
            margin: 16px 0 8px 0;
        }
        
        .table .table-primary {
            background-color: #cce7ff !important;
            color: #004085;
        }

        /* Table cell specific status styling (without heavy padding) */
        td.success {
            background-color: #dcfce7 !important;
            color: #166534;
            font-weight: 500;
        }

        td.warning {
            background-color: #fef3c7 !important;
            color: #92400e;
            font-weight: 500;
        }

        td.error {
            background-color: #fee2e2 !important;
            color: #991b1b;
            font-weight: 500;
        }

        /* Badge-like status indicators - subtle styling */
        .badge {
            display: inline-block;
            padding: 2px 6px;
            font-size: 0.75rem;
            font-weight: 600;
            line-height: 1.2;
            text-align: center;
            white-space: nowrap;
            vertical-align: baseline;
            border-radius: 12px;
            border: 1px solid;
        }

        .badge-success {
            color: #166534;
            background-color: transparent;
            border-color: #166534;
        }

        .badge-warning {
            color: #92400e;
            background-color: transparent;
            border-color: #92400e;
        }

        .badge-danger {
            color: #991b1b;
            background-color: transparent;
            border-color: #991b1b;
        }

        .badge-info {
            color: #0c5460;
            background-color: transparent;
            border-color: #0c5460;
        }

        .badge-primary {
            color: #004085;
            background-color: transparent;
            border-color: #004085;
        }
        
        .badge-secondary {
            color: #fff;
            background-color: #6c757d;
        }
        
        /* Metric cards - more subtle and professional */
        .metric { 
            display: inline-block; 
            margin: 8px; 
            padding: 16px; 
            background: white; 
            border-radius: 8px; 
            text-align: center; 
            min-width: 120px; 
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease; 
            position: relative;
        }
        .metric:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .metric .number { 
            font-size: 1.75rem; 
            font-weight: 700; 
            color: #1e293b; 
            margin-bottom: 10px; 
        }
        .metric .label { 
            font-size: 0.8rem; 
            color: #64748b; 
            font-weight: 500;
            line-height: 1.3;
        }
        
        /* Export button styling */
        .export-btn { 
            position: absolute; 
            top: 8px; 
            right: 8px; 
            background: #3b82f6; 
            color: white; 
            border: none; 
            border-radius: 6px; 
            width: 28px; 
            height: 28px; 
            font-size: 12px; 
            cursor: pointer; 
            opacity: 0.7; 
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .export-btn:hover { 
            background: #2563eb; 
            opacity: 1;
            transform: scale(1.1);
        }
        
        /* Tree and toggle styling */
        .ou-tree, .group-tree { margin: 20px 0; }
        .ou-item, .group-item { margin: 2px 0; }
        .ou-toggle, .group-toggle { 
            cursor: pointer; 
            user-select: none; 
            padding: 8px 12px; 
            border-radius: 6px; 
            transition: all 0.2s ease; 
            display: inline-block;
            color: #374151;
        }
        .ou-toggle:hover, .group-toggle:hover { 
            background: #f3f4f6;
            color: #1f2937;
        }
        .ou-toggle::before, .group-toggle::before { 
            content: '▶'; 
            display: inline-block; 
            width: 12px; 
            color: #6b7280; 
            font-size: 10px; 
            transition: transform 0.2s ease; 
        }
        .ou-toggle.expanded::before, .group-toggle.expanded::before { 
            content: '▼'; 
            transform: rotate(0deg); 
        }
        .ou-children, .group-children { 
            margin-left: 20px; 
            display: none; 
            border-left: 2px solid #e5e7eb; 
            padding-left: 12px; 
            margin-top: 4px; 
        }
        .ou-children.show, .group-children.show { 
            display: block; 
            animation: fadeIn 0.2s ease; 
        }
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(-4px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        
        /* Stats and level styling */
        .ou-stats, .group-stats { 
            font-size: 0.75rem; 
            color: #6b7280; 
            margin-left: 8px; 
            background: #f3f4f6; 
            padding: 2px 8px; 
            border-radius: 12px; 
            display: inline-block; 
        }
        .ou-level-0 { margin-left: 0px; }
        .ou-level-1 { margin-left: 16px; }
        .ou-level-2 { margin-left: 32px; }
        .ou-level-3 { margin-left: 48px; }
        .ou-level-4 { margin-left: 64px; }
        .ou-level-5 { margin-left: 80px; }
        
        /* Group tree styling */
        .group-tree { 
            max-height: 500px; 
            overflow-y: auto; 
            border: 1px solid #e5e7eb; 
            padding: 16px; 
            border-radius: 8px; 
            background: #fafafa; 
        }
        .group-tree::-webkit-scrollbar { width: 6px; }
        .group-tree::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 3px; }
        .group-tree::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .group-tree::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        .group-name { font-weight: 600; color: #374151; }
        .group-scope { 
            font-size: 0.75rem; 
            color: #6b7280; 
            margin-left: 6px; 
            background: #e5e7eb; 
            padding: 2px 6px; 
            border-radius: 8px; 
        }
        
        /* Risk level styling */
        .high-risk { color: #dc2626; font-weight: 600; }
        .medium-risk { color: #d97706; font-weight: 500; }
        .low-risk { color: #059669; font-weight: 500; }
        
        /* Controls panel */
        .controls-panel { 
            margin: 28px 0; 
            padding: 24px; 
            background: #f8fafc; 
            border-radius: 8px; 
            border: 1px solid #e2e8f0; 
        }
        .control-btn { 
            margin: 6px; 
            padding: 10px 20px; 
            background: #3b82f6; 
            color: white; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer; 
            font-weight: 500; 
            transition: all 0.2s ease;
            font-size: 0.8rem;
        }
        .control-btn:hover { 
            background: #2563eb; 
            transform: translateY(-1px);
        }
        .control-btn:active { transform: translateY(0px); }
        
        /* Template styling */
        .template-list { margin: 12px 0; }
        .template-tag { 
            display: inline-block; 
            margin: 4px 6px 4px 0; 
            padding: 6px 12px; 
            background: #eff6ff; 
            border: 1px solid #3b82f6; 
            border-radius: 16px; 
            font-size: 0.75rem; 
            color: #1e40af; 
            font-weight: 500; 
            transition: all 0.2s ease; 
        }
        .template-tag:hover { 
            background: #dbeafe;
            box-shadow: 0 2px 4px rgba(59, 130, 246, 0.1);
        }
        
        /* Status indicators */
        .status-indicator { 
            display: flex; 
            align-items: center; 
            margin: 12px 0; 
            padding: 12px 16px; 
            border-radius: 8px; 
            font-weight: 500; 
        }
        .status-indicator.success { 
            background: #dcfce7; 
            border: 1px solid #22c55e; 
            color: #166534; 
        }
        .status-indicator.warning { 
            background: #fef3c7; 
            border: 1px solid #f59e0b; 
            color: #92400e; 
        }
        .status-indicator .status-icon { margin-right: 8px; font-size: 16px; }
        .status.success {
            color: #166534;
            font-weight: 600;
            border-left: 2px solid #166534;
            padding-left: 6px;
        }
        .status.warning {
            color: #92400e;
            font-weight: 600;
            border-left: 2px solid #92400e;
            padding-left: 6px;
        }
        .status.error {
            color: #991b1b;
            font-weight: 600;
            border-left: 2px solid #991b1b;
            padding-left: 6px;
        }
        
        .info-grid { margin: 12px 0; }
        .info-grid p { margin: 6px 0; }
        
        /* Responsive design improvements */
        @media (max-width: 768px) {
            body { padding: 12px 16px; font-size: 13px; }
            .container { max-width: 100%; padding: 0 10px; }
            .header { padding: 24px 20px; }
            .header h1 { font-size: 1.5rem; }
            .section { padding: 20px 24px; margin: 16px 0; }
            .metric { min-width: 110px; margin: 6px; padding: 14px; }
            .metric .number { font-size: 1.5rem; }
            .metric .label { font-size: 0.75rem; }
            table { font-size: 0.8rem; }
            th, td { padding: 10px 14px; }
            .section h2 { font-size: 1.25rem; }
            .section h3 { font-size: 1rem; }
        }
        
        @media (max-width: 480px) {
            body { padding: 8px 12px; }
            .header { padding: 20px 16px; }
            .section { padding: 16px 20px; }
            .metric { min-width: 90px; margin: 4px; padding: 12px; }
        }
        
        /* Status indicators with left border styling - more subtle and professional */
        .status-online {
            border-left: 4px solid #10b981 !important;
            background-color: rgba(16, 185, 129, 0.05) !important;
            padding-left: 12px !important;
        }
        .status-warning {
            border-left: 4px solid #f59e0b !important;
            background-color: rgba(245, 158, 11, 0.05) !important;
            padding-left: 12px !important;
        }
        .status-error {
            border-left: 4px solid #ef4444 !important;
            background-color: rgba(239, 68, 68, 0.05) !important;
            padding-left: 12px !important;
        }
        .status-unknown {
            border-left: 4px solid #6b7280 !important;
            background-color: rgba(107, 114, 128, 0.05) !important;
            padding-left: 12px !important;
        }

        /* DNS Table specific styles */
        .table-responsive {
            overflow-x: auto;
            margin-bottom: 1rem;
        }

        .dns-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            background: white;
        }

        .dns-table th {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            font-weight: 500;
            padding: 12px 15px;
            text-align: left;
            border: none;
        }

        .dns-table td {
            padding: 12px 15px;
            border: none;
            border-bottom: 1px solid #e2e8f0;
        }

        .dns-table tr:nth-child(even) {
            background-color: rgba(52,152,219,0.03);
        }

        .dns-table tr:hover {
            background-color: rgba(52,152,219,0.08);
        }

        .dns-table .status {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .dns-table .status.success {
            color: #166534;
            font-weight: 600;
            border-left: 3px solid #166534;
            padding-left: 8px;
        }

        .dns-table .status.warning {
            color: #92400e;
            font-weight: 600;
            border-left: 3px solid #92400e;
            padding-left: 8px;
        }

        .dns-table .status.error {
            color: #991b1b;
            font-weight: 600;
            border-left: 3px solid #991b1b;
            padding-left: 8px;
        }

        @media (max-width: 768px) {
            .dns-table {
                font-size: 0.875rem;
            }

            .dns-table th,
            .dns-table td {
                padding: 8px 10px;
            }
        }

        .fsmo-summary { 
            margin-top: 16px; 
            padding: 12px 16px; 
            border-radius: 8px; 
            font-weight: 500;
        }
    </style>
    <script>
        function exportToCSV(data, filename) {
            // Function to properly escape CSV fields
            function escapeCSVField(field) {
                if (field === null || field === undefined) {
                    return '';
                }
                const stringField = String(field);
                // If field contains comma, quotes, or newlines, wrap in quotes and escape internal quotes
                if (stringField.includes(',') || stringField.includes('"') || stringField.includes('\n') || stringField.includes('\r')) {
                    return '"' + stringField.replace(/"/g, '""') + '"';
                }
                return stringField;
            }
            
            const csvContent = "data:text/csv;charset=utf-8," + 
                data.map(row => row.map(field => escapeCSVField(field)).join(",")).join("\n");
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", filename);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        function exportUserStats() {
            const userStats = [
                ["Metric", "Count"],
                ["Total Users", "12"],
                ["Enabled Users", "7"],
                ["Disabled Users", "5"],
                ["Password Never Expires", "3"],
                ["Inactive 90+ Days", "0"],
                ["Locked Out Users", "0"]
            ];
            exportToCSV(userStats, "user_statistics.csv");
        }
        
        function exportComputerStats() {
            const computerStats = [
                ["Metric", "Count"],
                ["Total Computers", "3"],
                ["Enabled Computers", "3"],
                ["Disabled Computers", "0"],
                ["Windows Servers", "2"],
                ["Windows Workstations", "1"],
                ["Inactive 90+ Days", "0"]
            ];
            exportToCSV(computerStats, "computer_statistics.csv");
        }
        
        // Individual metric export functions
        function exportEnabledUsers() {
            const data = [
                ["Name", "SamAccountName", "Last Logon", "Password Last Set"],
                ["adminuser", "adminuser", "09/15/2025 21:38:00", "09/11/2025 22:28:04"],                 ["Hamid Cherifi", "hamid.cherifi", "", "06/17/2025 08:02:51"],                 ["admin utilisateur", "adminu", "", "08/16/2025 15:58:55"],                 ["test user20", "tuser20", "", "08/16/2025 17:04:53"],                 ["test user2", "tuser2", "", "08/16/2025 17:05:47"],                 ["Mohamed", "zmohamed", "", "08/17/2025 12:52:25"],                 ["zmohamed", "m.mohamed", "", "08/17/2025 13:19:47"],
            ];
            exportToCSV(data, "enabled_users.csv");
        }
        
        function exportDisabledUsers() {
            const data = [
                ["Name", "SamAccountName", "Last Logon", "Password Last Set"],
                ["Guest", "Guest", "", ""],                 ["krbtgt", "krbtgt", "", "06/16/2025 21:22:03"],                 ["test user", "tuser", "", "08/16/2025 17:02:18"],                 ["Abderraouf", "K.abderraouf", "", ""],                 ["Akram", "H.akram", "", ""],
            ];
            exportToCSV(data, "disabled_users.csv");
        }
        
        function exportPasswordNeverExpiresUsers() {
            const data = [
                ["Name", "SamAccountName", "Last Logon", "Password Last Set", "Enabled"],
                ["Guest", "Guest", "", "", "False"],                 ["Hamid Cherifi", "hamid.cherifi", "", "06/17/2025 08:02:51", "True"],                 ["admin utilisateur", "adminu", "", "08/16/2025 15:58:55", "True"],
            ];
            exportToCSV(data, "password_never_expires_users.csv");
        }
        
        function exportInactiveUsers() {
            const data = [
                ["Name", "SamAccountName", "Last Logon", "Enabled"],

            ];
            exportToCSV(data, "inactive_users_90days.csv");
        }
        
        function exportLockedOutUsers() {
            const data = [
                ["Name", "SamAccountName", "Account Lockout Time", "Last Logon"],

            ];
            exportToCSV(data, "locked_out_users.csv");
        }
        
        function exportEnabledComputers() {
            const data = [
                ["Name", "Operating System", "Last Logon"],
                ["adVM", "Windows Server 2019 Datacenter", "09/09/2025 21:48:42"],                 ["DEMOC", "Windows 11 Enterprise N", "08/16/2025 15:23:06"],                 ["advm2", "Windows Server 2019 Datacenter", "09/15/2025 11:52:29"],
            ];
            exportToCSV(data, "enabled_computers.csv");
        }
        
        function exportDisabledComputers() {
            const data = [
                ["Name", "Operating System", "Last Logon"],

            ];
            exportToCSV(data, "disabled_computers.csv");
        }
        
        function exportInactiveComputers() {
            const data = [
                ["Name", "Operating System", "Last Logon"],

            ];
            exportToCSV(data, "inactive_computers_90days.csv");
        }
        
        function exportWindowsServers() {
            const data = [
                ["Name", "Operating System", "Last Logon", "Enabled"],
                ["adVM", "Windows Server 2019 Datacenter", "09/09/2025 21:48:42", "True"],                 ["advm2", "Windows Server 2019 Datacenter", "09/15/2025 11:52:29", "True"],
            ];
            exportToCSV(data, "windows_servers.csv");
        }
        
        function exportWindowsWorkstations() {
            const data = [
                ["Name", "Operating System", "Last Logon", "Enabled"],
                ["DEMOC", "Windows 11 Enterprise N", "08/16/2025 15:23:06", "True"],
            ];
            exportToCSV(data, "windows_workstations.csv");
        }
        
        function exportTotalUsers() {
            const data = [
                ["Name", "SamAccountName", "Enabled", "Last Logon", "Password Last Set", "Password Never Expires", "Locked Out"],
                ["adminuser", "adminuser", "True", "09/15/2025 21:38:00", "09/11/2025 22:28:04", "False", ""],                 ["Guest", "Guest", "False", "", "", "True", ""],                 ["krbtgt", "krbtgt", "False", "", "06/16/2025 21:22:03", "False", ""],                 ["Hamid Cherifi", "hamid.cherifi", "True", "", "06/17/2025 08:02:51", "True", ""],                 ["admin utilisateur", "adminu", "True", "", "08/16/2025 15:58:55", "True", ""],                 ["test user", "tuser", "False", "", "08/16/2025 17:02:18", "False", ""],                 ["test user20", "tuser20", "True", "", "08/16/2025 17:04:53", "False", ""],                 ["test user2", "tuser2", "True", "", "08/16/2025 17:05:47", "False", ""],                 ["Mohamed", "zmohamed", "True", "", "08/17/2025 12:52:25", "False", ""],                 ["zmohamed", "m.mohamed", "True", "", "08/17/2025 13:19:47", "False", ""],                 ["Abderraouf", "K.abderraouf", "False", "", "", "False", ""],                 ["Akram", "H.akram", "False", "", "", "False", ""],
            ];
            exportToCSV(data, "total_users.csv");
        }
        
        function exportTotalComputers() {
            const data = [
                ["Name", "Operating System", "Enabled", "Last Logon", "Type"],
                ["adVM", "Windows Server 2019 Datacenter", "True", "09/09/2025 21:48:42", "Server"],                 ["DEMOC", "Windows 11 Enterprise N", "True", "08/16/2025 15:23:06", "Workstation"],                 ["advm2", "Windows Server 2019 Datacenter", "True", "09/15/2025 11:52:29", "Server"],
            ];
            exportToCSV(data, "total_computers.csv");
        }
    </script>
</head>
<body class="bg-light">
    <div class="container-fluid">
        <!-- Header Section -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card shadow-sm border-0">
                    <div class="card-header bg-primary text-white">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h1 class="h3 mb-0">
                                    <i class="bi bi-shield-check me-2"></i>
                                    Active Directory Audit Report
                                </h1>
                            </div>
                            <div class="col-md-4 text-md-end">
                                <small class="opacity-75">
                                    <i class="bi bi-calendar3 me-1"></i>
                                    Generated: 2025-09-19 19:19:47
                                </small>
                            </div>
                        </div>
                    </div>
                    <div class="card-body bg-gradient">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="d-flex align-items-center mb-2">
                                    <i class="bi bi-building text-primary me-2"></i>
                                    <strong class="me-2">Domain:</strong>
                                    <span class="badge bg-light text-dark">demo.local</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="d-flex align-items-center mb-2">
                                    <i class="bi bi-diagram-3 text-success me-2"></i>
                                    <strong class="me-2">Forest:</strong>
                                    <span class="badge bg-light text-dark">demo.local</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stats Dashboard Section -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card shadow-sm border-0">
                    <div class="card-header bg-light">
                        <h4 class="mb-0">
                            <i class="bi bi-graph-up text-primary me-2"></i>
                            Audit Overview & Key Metrics
                        </h4>
                    </div>
                    <div class="card-body">
                        <div class="row g-3">
                            <!-- Domain Controllers Stats -->
                            <div class="col-xl-3 col-lg-6 col-md-6">
                                <div class="card bg-primary bg-gradient text-white h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <h6 class="text-uppercase text-white-50 small">Domain Controllers</h6>
                                                <h2 class="mb-0" id="dcCount">2</h2>
                                                <span class="small">Total DCs Found</span>
                                            </div>
                                            <div class="align-self-center">
                                                <i class="bi bi-server" style="font-size: 2rem; opacity: 0.8;"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- User Accounts Stats -->
                            <div class="col-xl-3 col-lg-6 col-md-6">
                                <div class="card bg-success bg-gradient text-white h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <h6 class="text-uppercase text-white-50 small">User Accounts</h6>
                                                <h2 class="mb-0" id="userCount">12</h2>
                                                <span class="small">Active Users</span>
                                            </div>
                                            <div class="align-self-center">
                                                <i class="bi bi-people" style="font-size: 2rem; opacity: 0.8;"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Computer Accounts Stats -->
                            <div class="col-xl-3 col-lg-6 col-md-6">
                                <div class="card bg-info bg-gradient text-white h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <h6 class="text-uppercase text-white-50 small">Computer Accounts</h6>
                                                <h2 class="mb-0" id="computerCount">3</h2>
                                                <span class="small">Total Computers</span>
                                            </div>
                                            <div class="align-self-center">
                                                <i class="bi bi-laptop" style="font-size: 2rem; opacity: 0.8;"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Security Events Stats -->
                            <div class="col-xl-3 col-lg-6 col-md-6">
                                <div class="card bg-warning bg-gradient text-white h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <div>
                                                <h6 class="text-uppercase text-white-50 small">Security Events</h6>
                                                <h2 class="mb-0" id="securityEvents">0</h2>
                                                <span class="small">Critical Events</span>
                                            </div>
                                            <div class="align-self-center">
                                                <i class="bi bi-shield-exclamation" style="font-size: 2rem; opacity: 0.8;"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    <!-- ============================================ -->
    <!-- 🏗️ SECTION 1: INFRASTRUCTURE & FOUNDATION -->
    <!-- ============================================ -->

    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-header bg-secondary text-white">
                    <h4 class="mb-0">
                        <i class="bi bi-diagram-3 me-2"></i>
                        Infrastructure & Foundation
                    </h4>
                    <small class="text-white-50">Core Active Directory infrastructure components including domain controllers, replication, DNS, and forest structure.</small>
                </div>
                <div class="card-body">                    <div class="row">
                        <div class="col-12">

    <div class="section">
        <h2>🖥️ Domain Controllers Analysis</h2><h3>Domain Controllers Summary</h3><table><thead><tr><th>DC Name</th><th>Domain</th><th>OS Version</th><th>IPv4</th><th>Global Catalog</th><th>Read Only</th></tr></thead><tbody><tr><td><strong>adVM.demo.local</strong></td><td>demo.local</td><td>Windows Server 2019 Datacenter</td><td>10.0.0.4</td><td><span class="badge badge-success">Yes</span></td><td><span class="badge badge-success">No</span></td></tr><tr><td><strong>advm2.demo.local</strong></td><td>demo.local</td><td>Windows Server 2019 Datacenter</td><td>10.0.0.6</td><td><span class="badge badge-success">Yes</span></td><td><span class="badge badge-success">No</span></td></tr></tbody></table><h3>Detailed Health Report</h3><table><thead><tr><th>DC Name</th><th>Domain</th><th>Uptime</th><th>Time Sync</th><th>Disk Free %</th><th>Disk Free GB</th><th>SYSVOL/Netlogon</th><th>Services</th><th>DCDiag Summary</th></tr></thead><tbody><tr><td><strong>adVM.demo.local</strong></td><td>demo.local</td><td>9 days, 21h 06m</td><td>0s</td><td>82.47%</td><td>104.33 GB</td><td>Missing</td><td>DNS✓ NTDS✓ NETLOGON✓ KDC✓ W32Time✓</td><td>1/8</td></tr><tr><td><strong>advm2.demo.local</strong></td><td>demo.local</td><td>Unreachable</td><td>Unreachable</td><td>Unreachable%</td><td>Unreachable GB</td><td>Unreachable</td><td>DNS⚠ NTDS⚠ NETLOGON⚠ KDC⚠ W32Time⚠</td><td>0/1</td></tr></table><h3>Detailed DCDiag Test Results</h3><div class='controls-panel'><strong>DCDiag Controls:</strong> <button class='control-btn' onclick='expandAllDCDiag()'>Expand All</button><button class='control-btn' onclick='collapseAllDCDiag()'>Collapse All</button><button class='control-btn' onclick='showFailedDCDiagOnly()'>Show Failed Only</button><button class='control-btn' onclick='showAllDCDiag()'>Show All</button></div><div class='group-item'><span class='group-toggle' onclick='toggleDCDiag("adVM_demo_local")'><strong>adVM.demo.local</strong></span><div class='group-children' id='dcdiag-adVM_demo_local'><table><thead><tr><th>Test Name</th><th>Result</th></tr></thead><tbody><tr class=''><td>Count</td><td>169</td></tr><tr class=''><td>Length</td><td>169</td></tr><tr class=''><td>LongLength</td><td>169</td></tr><tr class=''><td>Rank</td><td>1</td></tr><tr class=''><td>SyncRoot</td><td> Directory Server Diagnosis   Performing initial setup:     Trying to find home server...     Home Server = adVM     * Identified AD Forest.     Done gathering initial info.   Doing initial required tests         Testing server: Default-First-Site-Name\adVM        Starting test: Connectivity           ......................... adVM passed test Connectivity    Doing primary tests         Testing server: Default-First-Site-Name\adVM        Starting test: Advertising           ......................... adVM passed test Advertising        Starting test: FrsEvent           ......................... adVM passed test FrsEvent        Starting test: DFSREvent           There are warning or error events within the last 24 hours after the           SYSVOL has been shared.  Failing SYSVOL replication problems may cause           Group Policy problems.           ......................... adVM failed test DFSREvent        Starting test: SysVolCheck           ......................... adVM passed test SysVolCheck        Starting test: KccEvent           ......................... adVM passed test KccEvent        Starting test: KnowsOfRoleHolders           ......................... adVM passed test KnowsOfRoleHolders        Starting test: MachineAccount           ......................... adVM passed test MachineAccount        Starting test: NCSecDesc           ......................... adVM passed test NCSecDesc        Starting test: NetLogons           ......................... adVM passed test NetLogons        Starting test: ObjectsReplicated           ......................... adVM passed test ObjectsReplicated        Starting test: Replications           [ADVM2] DsBindWithSpnEx() failed with error 1722,           The RPC server is unavailable..          ......................... adVM failed test Replications        Starting test: RidManager           ......................... adVM passed test RidManager        Starting test: Services           ......................... adVM passed test Services        Starting test: SystemLog           ......................... adVM passed test SystemLog        Starting test: VerifyReferences           ......................... adVM passed test VerifyReferences             Running partition tests on : ForestDnsZones        Starting test: CheckSDRefDom           ......................... ForestDnsZones passed test CheckSDRefDom        Starting test: CrossRefValidation           ......................... ForestDnsZones passed test           CrossRefValidation         Running partition tests on : DomainDnsZones        Starting test: CheckSDRefDom           ......................... DomainDnsZones passed test CheckSDRefDom        Starting test: CrossRefValidation           ......................... DomainDnsZones passed test           CrossRefValidation         Running partition tests on : Schema        Starting test: CheckSDRefDom           ......................... Schema passed test CheckSDRefDom        Starting test: CrossRefValidation           ......................... Schema passed test CrossRefValidation         Running partition tests on : Configuration        Starting test: CheckSDRefDom           ......................... Configuration passed test CheckSDRefDom        Starting test: CrossRefValidation           ......................... Configuration passed test CrossRefValidation         Running partition tests on : demo        Starting test: CheckSDRefDom           ......................... demo passed test CheckSDRefDom        Starting test: CrossRefValidation           ......................... demo passed test CrossRefValidation         Running enterprise tests on : demo.local        Starting test: LocatorCheck           ......................... demo.local passed test LocatorCheck        Starting test: Intersite           ......................... demo.local passed test Intersite </td></tr><tr class=''><td>IsReadOnly</td><td>False</td></tr><tr class='error'><td>IsFixedSize</td><td>True</td></tr><tr class=''><td>IsSynchronized</td><td>False</td></tr></tbody></table></div></div><div class='group-item'><span class='group-toggle' onclick='toggleDCDiag("advm2_demo_local")'><strong>advm2.demo.local</strong></span><div class='group-children' id='dcdiag-advm2_demo_local'><table><thead><tr><th>Test Name</th><th>Result</th></tr></thead><tbody><tr class=''><td>Length</td><td>31</td></tr></tbody></table></div></div>    <script>
    function toggleDCDiag(dcId) {
        var toggle = event.target.closest('.group-toggle');
        var children = document.getElementById('dcdiag-' + dcId);
        
        if (children) {
            if (children.classList.contains('show')) {
                children.classList.remove('show');
                toggle.classList.remove('expanded');
            } else {
                children.classList.add('show');
                toggle.classList.add('expanded');
            }
        }
    }

    function expandAllDCDiag() {
        document.querySelectorAll('.group-toggle').forEach(t => t.classList.add('expanded'));
        document.querySelectorAll('[id^="dcdiag-"]').forEach(d => d.classList.add('show'));
    }

    function collapseAllDCDiag() {
        document.querySelectorAll('.group-toggle').forEach(t => t.classList.remove('expanded'));
        document.querySelectorAll('[id^="dcdiag-"]').forEach(d => d.classList.remove('show'));
    }

    function showFailedDCDiagOnly() {
        document.querySelectorAll('.group-item').forEach(item => {
            const anyFail = item.querySelector('tr.error') !== null;
            item.style.display = anyFail ? 'block' : 'none';
        });
    }

    function showAllDCDiag() {
        document.querySelectorAll('.group-item').forEach(item => {
            item.style.display = 'block';
        });
    }
    </script>    </div>

    <div class="section">
        <h2>📊 DC Performance Metrics</h2>
        <table>
            <tr>
                <th>Domain Controller</th>
                <th>CPU Usage</th>
                <th>Memory Usage</th>
                <th>AD Database Size</th>
                <th>Log File Size</th>
                <th>LDAP Connections</th>
            </tr>                <tr>
                    <td><strong>adVM.demo.local</strong></td>
                    <td>16%</td>
                    <td>38.2% (3.06 GB / 8 GB)</td>
                    <td>Access Denied</td>
                    <td>Access Denied</td>
                    <td>0</td>
                </tr>                <tr>
                    <td><strong>advm2.demo.local</strong></td>
                    <td>0%</td>
                    <td>N/A</td>
                    <td>Access Denied</td>
                    <td>Access Denied</td>
                    <td>0</td>
                </tr>        </table>
    </div>


    <div class="section">
        <h2>🔄 Replication Health Assessment</h2><div class='warning'>Replication issues detected:</div><table><thead><tr><th>Source DC</th><th>Destination DC</th><th>Naming Context</th><th>Failures</th><th>Last Success</th></tr></thead><tbody><tr><td>advm2.demo.local</td><td></td><td></td><td></td><td></td></tr></tbody></table></div>
<div class="section">
    <h2>🌐 DNS Configuration Testing</h2><h3>📊 DNS Status Overview</h3><div class='table-responsive'><table class='dns-table'><thead><tr><th>Domain Controller</th><th>Connectivity</th><th>DNS Server IP</th><th>DCDiag DNS</th><th>Domain Resolution</th><th>Reverse Lookup</th><th>Scavenging</th><th>Issues Found</th></tr></thead><tbody><tr class='success'><td><strong>adVM.demo.local</strong></td><td><span class='status success'>Online</span></td><td>Unknown</td><td><span class='status success'>Passed</span></td><td>Failed</td><td>Failed</td><td>Unknown</td><td><span class='status error'>34 issues</span></td></tr><tr class='warning'><td><strong>advm2.demo.local</strong></td><td><span class='status warning'>Port 53 blocked</span></td><td>Unknown</td><td><span class='status warning'>Unknown</span></td><td>Unknown</td><td>Unknown</td><td>Unknown</td><td><span class='status warning'>1 issues</span></td></tr></tbody></table></div><h3>🔍 Detailed DNS Issues (35 total)</h3><h4>Issues on adVM.demo.local (34 issues)</h4><h5 class='info'>Obsolete Issues (34)</h5><div style='max-height: 300px; overflow-y: auto; border: 1px solid #e2e8f0; padding: 12px; border-radius: 8px; background: #fafafa;'><table><thead><tr><th>Issue</th><th>Details</th><th>Zone</th></tr></thead><tbody><tr class='info'><td>advm.demo.local. [NS] @</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [CNAME] 66927140-b7d6-46b8-938e-d6b659d3c018</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [A] advm</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [SRV] _kerberos._tcp.Default-First-Site-Name._sites.dc</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.Default-First-Site-Name._sites.dc</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [SRV] _kerberos._tcp.dc</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.dc</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.63dbe2d7-a489-4b0e-8ab7-7b080e92ace7.domains</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [A] gc</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.Default-First-Site-Name._sites.gc</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.gc</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.pdc</td><td>Found in zone _msdcs.demo.local</td><td>_msdcs.demo.local</td></tr><tr class='info'><td>advm.demo.local. [NS] @</td><td>Found in zone 0.in-addr.arpa</td><td>0.in-addr.arpa</td></tr><tr class='info'><td>advm.demo.local. [NS] @</td><td>Found in zone 127.in-addr.arpa</td><td>127.in-addr.arpa</td></tr><tr class='info'><td>advm.demo.local. [NS] @</td><td>Found in zone 255.in-addr.arpa</td><td>255.in-addr.arpa</td></tr><tr class='info'><td> [A] @</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td>advm.demo.local. [NS] @</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _gc._tcp.Default-First-Site-Name._sites</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _kerberos._tcp.Default-First-Site-Name._sites</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.Default-First-Site-Name._sites</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _gc._tcp</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _kerberos._tcp</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _kpasswd._tcp</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _kerberos._udp</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _kpasswd._udp</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [A] advm</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [A] DomainDnsZones</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.Default-First-Site-Name._sites.DomainDnsZones</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.DomainDnsZones</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [A] ForestDnsZones</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.Default-First-Site-Name._sites.ForestDnsZones</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td> [SRV] _ldap._tcp.ForestDnsZones</td><td>Found in zone demo.local</td><td>demo.local</td></tr><tr class='info'><td>advm.demo.local. [NS] @</td><td>Found in zone TrustAnchors</td><td>TrustAnchors</td></tr></tbody></table></div><h4>Issues on advm2.demo.local (1 issues)</h4><h5 class='error'>Connectivity Issues (1)</h5><table><thead><tr><th>Issue</th><th>Details</th></tr></thead><tbody><tr class='error'><td>Domain Controller is unreachable</td><td>Cannot perform DNS tests - Port 53 blocked</td></tr></tbody></table><div class='success'><h4>📈 DNS Health Summary</h4><div class='info-grid'><p><strong>Online Domain Controllers:</strong>  / 2</p><p><strong>Passed DCDiag DNS Tests:</strong>  /  (online DCs)</p><p><strong>Total DNS Issues Found:</strong> 35</p><p><strong>Obsolete DNS Records:</strong> 34</p></div></div>    </div>

    <div class="section">
        <h2>👑 FSMO Roles Verification</h2><table><thead><tr><th>Role</th><th>Server</th><th>Scope</th><th>Status</th></tr></thead><tbody><tr class='status-online'><td>Schema Master</td><td>adVM.demo.local</td><td>Forest</td><td>Online</td></tr><tr class='status-online'><td>Domain Naming Master</td><td>adVM.demo.local</td><td>Forest</td><td>Online</td></tr><tr class='status-online'><td>RID Master</td><td>adVM.demo.local</td><td>demo.local</td><td>Online</td></tr><tr class='status-online'><td>PDC Emulator</td><td>adVM.demo.local</td><td>demo.local</td><td>Online</td></tr><tr class='status-online'><td>Infrastructure Master</td><td>adVM.demo.local</td><td>demo.local</td><td>Online</td></tr></tbody></table><div class='fsmo-summary status-online'><strong>FSMO Health Summary:</strong> 5/5 roles online (100%)</div>    </div>

    <div class="section">
        <h2>🤝 Trust Relationships Analysis</h2><div class='success'>No external trusts configured</div>    </div>

    <div class="section">
        <h2>🏢 AD Sites & Services Audit</h2><h3>Sites</h3><table><thead><tr><th>Site Name</th><th>Description</th><th>Domain Controllers</th><th>Subnets</th></tr></thead><tbody><tr><td>Default-First-Site-Name</td><td></td><td>2</td><td></td></tr></tbody></table><h3>Site Links</h3><table><thead><tr><th>Link Name</th><th>Cost</th><th>Replication Frequency (min)</th><th>Sites</th></tr></thead><tbody><tr><td>DEFAULTIPSITELINK</td><td>100</td><td>180</td><td>CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=demo,DC=local</td></tr></tbody></table>    </div>

    <div class="section">
        <h2>📋 Group Policy Security Analysis</h2>        <div class="subsection">
            <h3>🎯 Security Overview</h3>
            <div class="row">
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-primary">4</h5>
                            <p class="card-text">Total GPOs</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-success">3</h5>
                            <p class="card-text">Linked GPOs</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-success">0</h5>
                            <p class="card-text">High Risk GPOs</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-success">0</h5>
                            <p class="card-text">Orphaned GPOs</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>        <div class="subsection">
            <h3>⚠️ Security Issues Found</h3>
            <div class="alert alert-warning">
                <strong>2 unique security issues detected across all GPOs:</strong>
                <ul class="mt-2"><li>Weak password length requirement (&lt; 14 characters)</li><li>Weak account lockout threshold</li>                </ul>
            </div>
        </div>        <div class="subsection">
            <h3>💡 Security Recommendations</h3>
            <div class="alert alert-info">
                <ul class="mb-0"><li>Set minimum password length to 14+ characters</li><li>Set account lockout threshold to 3-5 failed attempts</li>                </ul>
            </div>
        </div>        <div class="subsection">
            <h3>⚡ GPO Conflict Analysis</h3>
            <div class="row">
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-success">0</h5>
                            <p class="card-text">Total Conflicts</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-success">0</h5>
                            <p class="card-text">Critical Conflicts</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-success">0</h5>
                            <p class="card-text">Warning Conflicts</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5 class="card-title text-success">0</h5>
                            <p class="card-text">Affected OUs</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>        <div class="subsection">
            <h3>📊 Detailed GPO Analysis</h3>
            <div class="table-responsive">
                <table class="table table-striped table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>GPO Name</th>
                            <th>Status</th>
                            <th>Links</th>
                            <th>Last Modified</th>
                            <th>Issues</th>
                        </tr>
                    </thead>
                    <tbody>                        <tr class="table-warning">
                            <td><strong>Default Domain Policy</strong></td>
                            <td>⚠️ Medium Risk</td>
                            <td>
                                <span class="badge bg-success">5</span>
                                
                            </td>
                            <td class="text-muted">94 days ago</td>
                            <td><span class='badge bg-danger'>2</span></td>
                        </tr>                        <tr class="table-light">
                            <td colspan="5">
                                <div class="ms-3"><small><strong>Security Issues:</strong></small><ul class='small mb-1'><li class='text-danger'>Weak password length requirement (&lt; 14 characters)</li><li class='text-danger'>Weak account lockout threshold</li></ul>                                </div>
                            </td>
                        </tr>                        <tr class="table-success">
                            <td><strong>New Group Policy Object</strong></td>
                            <td>✅ Healthy</td>
                            <td>
                                <span class="badge bg-success">5</span>
                                
                            </td>
                            <td class="text-muted">87 days ago</td>
                            <td><span class='badge bg-success'>0</span></td>
                        </tr>                        <tr class="table-success">
                            <td><strong>Default Domain Controllers Policy</strong></td>
                            <td>✅ Healthy</td>
                            <td>
                                <span class="badge bg-success">5</span>
                                
                            </td>
                            <td class="text-muted">29 days ago</td>
                            <td><span class='badge bg-success'>0</span></td>
                        </tr>                        <tr class="table-success">
                            <td><strong>test gpo not linked</strong></td>
                            <td>✅ Healthy</td>
                            <td>
                                <span class="badge bg-secondary">0</span>
                                <span class="badge bg-warning">Unlinked</span>
                            </td>
                            <td class="text-muted">44 days ago</td>
                            <td><span class='badge bg-success'>0</span></td>
                        </tr>                    </tbody>
                </table>
            </div>
        </div>        <div class="subsection">
            <h3>🔗 GPO Link Analysis</h3>
            <div class="table-responsive">
                <table class="table table-sm">
                    <thead class="table-secondary">
                        <tr>
                            <th>GPO Name</th>
                            <th>Linked To</th>
                            <th>Link Status</th>
                            <th>Enforced</th>
                            <th>Order</th>
                        </tr>
                    </thead>
                    <tbody>                        <tr>
                            <td>Default Domain Policy</td>
                            <td>🏢 Domain Root</td>
                            <td><span class='badge bg-success'>Enabled</span></td>
                            <td><span class='badge bg-light text-dark'>Normal</span></td>
                            <td><span class='badge bg-info'>1</span></td>
                        </tr>                        <tr>
                            <td>Default Domain Controllers Policy</td>
                            <td>📁 Domain Controllers</td>
                            <td><span class='badge bg-success'>Enabled</span></td>
                            <td><span class='badge bg-light text-dark'>Normal</span></td>
                            <td><span class='badge bg-info'>1</span></td>
                        </tr>                        <tr>
                            <td>New Group Policy Object</td>
                            <td>📁 company</td>
                            <td><span class='badge bg-success'>Enabled</span></td>
                            <td><span class='badge bg-light text-dark'>Normal</span></td>
                            <td><span class='badge bg-info'>1</span></td>
                        </tr>                    </tbody>
                </table>
            </div>
        </div>    </div>

    <div class="section">
        <h2>🏗️ Schema Architecture</h2><div class='error'>Schema Analysis Error: Method invocation failed because [Microsoft.ActiveDirectory.Management.ADPropertyValueCollection] does not contain a method named 'op_Addition'.</div>    </div>

    <!-- ============================================ -->
    <!-- 👥 SECTION 2: IDENTITY & ACCESS MANAGEMENT -->
    <!-- ============================================ -->


    <div class="section">
        <h2>👥 User & Computer Accounts Analysis</h2>        <h3>👥 User Account Statistics</h3>
        <div class="metric">
            <button class="export-btn" onclick="exportTotalUsers()" title="Export All Users">📥</button>
            <div class="number">12</div>
            <div class="label">Total Users</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportEnabledUsers()" title="Export Enabled Users">📥</button>
            <div class="number">7</div>
            <div class="label">Enabled</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportDisabledUsers()" title="Export Disabled Users">📥</button>
            <div class="number">5</div>
            <div class="label">Disabled</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportPasswordNeverExpiresUsers()" title="Export Users with Non-Expiring Passwords">📥</button>
            <div class="number">3</div>
            <div class="label">Never Expires</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportInactiveUsers()" title="Export Inactive Users">📥</button>
            <div class="number">0</div>
            <div class="label">Inactive 90d</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportLockedOutUsers()" title="Export Locked Out Users">📥</button>
            <div class="number">0</div>
            <div class="label">Locked Out</div>
        </div>
        
        <h3>💻 Computer Account Statistics</h3>
        <div class="metric">
            <button class="export-btn" onclick="exportTotalComputers()" title="Export All Computers">📥</button>
            <div class="number">3</div>
            <div class="label">Total Computers</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportEnabledComputers()" title="Export Enabled Computers">📥</button>
            <div class="number">3</div>
            <div class="label">Enabled</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportDisabledComputers()" title="Export Disabled Computers">📥</button>
            <div class="number">0</div>
            <div class="label">Disabled</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportWindowsServers()" title="Export Windows Servers">📥</button>
            <div class="number">2</div>
            <div class="label">Servers</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportWindowsWorkstations()" title="Export Windows Workstations">📥</button>
            <div class="number">1</div>
            <div class="label">Workstations</div>
        </div>
        <div class="metric">
            <button class="export-btn" onclick="exportInactiveComputers()" title="Export Inactive Computers">📥</button>
            <div class="number">0</div>
            <div class="label">Inactive 90d</div>
        </div>    </div>

    <!-- ============================================ -->
    <!-- 🔒 SECTION 3: SECURITY ANALYSIS -->
    <!-- ============================================ -->


    <div class="section">
        <h2>🔒 Security Analysis & Risk Assessment</h2><div class='warning'><strong>Security Findings:</strong><ul><li>Weak minimum password length in default policy: 7</li><li>No Password Settings Objects (PSOs) configured - consider implementing for privileged accounts</li><li>KRBTGT account password is 94 days old - consider resetting soon</li><li>Active Directory Recycle Bin is not enabled - consider enabling for accidental deletion protection</li><li>2 enabled accounts with non-expiring passwords</li></ul></div><h3>Password Policies</h3><h4>Default Domain Password Policy</h4><table><thead><tr><th>Setting</th><th>Value</th></tr></thead><tbody><tr><td>Minimum Password Length</td><td>7</td></tr><tr><td>Password Complexity</td><td>True</td></tr><tr><td>Maximum Password Age</td><td>42.00:00:00</td></tr><tr><td>Minimum Password Age</td><td>1.00:00:00</td></tr><tr><td>Password History Count</td><td>24</td></tr><tr><td>Lockout Threshold</td><td>0</td></tr></tbody></table><div class='warning'><strong>No Password Settings Objects (PSOs) configured</strong><br/>Consider implementing Fine-Grained Password Policies for privileged accounts.</div><h3>Privileged Group Membership</h3><div class='metric'><div class='number'>1</div><div class='label'>Domain Admins</div></div><div class='metric'><div class='number'>1</div><div class='label'>Enterprise Admins</div></div><div class='metric'><div class='number'>1</div><div class='label'>Schema Admins</div></div><h3>🔑 KRBTGT Account Status</h3><div class='warning'><h4>KRBTGT Password Information</h4><div class='info-grid'><p><strong>Password Last Set:</strong> 06/16/2025 21:22:03</p><p><strong>Password Age:</strong> 94 days</p><p><strong>Status:</strong> Warning</p></div><p><strong>⚠️ Recommendation:</strong> Consider resetting the KRBTGT password soon. Best practice is to reset every 90-180 days.</p></div><h3>🗑️ Active Directory Recycle Bin</h3><div class='warning'><h4>⚠️ AD Recycle Bin is Disabled</h4><p><strong>Recommendation:</strong> Enable the Active Directory Recycle Bin feature to protect against accidental object deletions.</p><p>This feature allows recovery of deleted AD objects without requiring a system state restore.</p></div>    </div>

    <div class="section">
        <h2>🏗️ OU Hierarchy Mapping</h2><div class='ou-tree' id='ou-tree'><div class='ou-item ou-level-0'><span class='ou-toggle' onclick='toggleOU("OU_company_DC_demo_DC_local")'><strong>company</strong><span class='ou-stats'>(Users: 0, Computers: 0, Groups: 0)</span></span><div class='ou-children' id='children-OU_company_DC_demo_DC_local'><div class='ou-item ou-level-1'><span class='ou-item'>&nbsp;&nbsp;&nbsp;<strong>DRH</strong><span class='ou-stats'>(Users: 0, Computers: 0, Groups: 2)</span></span></div><div class='ou-item ou-level-1'><span class='ou-toggle' onclick='toggleOU("OU_DSI_OU_company_DC_demo_DC_local")'><strong>DSI</strong><span class='ou-stats'>(Users: 0, Computers: 0, Groups: 0)</span></span><div class='ou-children' id='children-OU_DSI_OU_company_DC_demo_DC_local'><div class='ou-item ou-level-2'><span class='ou-item'>&nbsp;&nbsp;&nbsp;<strong>Computers</strong><span class='ou-stats'>(Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='ou-item ou-level-2'><span class='ou-item'>&nbsp;&nbsp;&nbsp;<strong>users</strong><span class='ou-stats'>(Users: 0, Computers: 0, Groups: 0)</span></span></div></div></div></div></div><div class='ou-item ou-level-0'><span class='ou-item'>&nbsp;&nbsp;&nbsp;<strong>Domain Controllers</strong><span class='ou-stats'>(Users: 0, Computers: 2, Groups: 0)</span></span></div></div>    <script>
    function toggleOU(ouId) {
        var toggle = event.target;
        var children = document.getElementById('children-' + ouId);
        
        if (children) {
            if (children.classList.contains('show')) {
                children.classList.remove('show');
                toggle.classList.remove('expanded');
            } else {
                children.classList.add('show');
                toggle.classList.add('expanded');
            }
        }
    }
    </script>    </div>

    <div class="section">
        <h2>🔍 Security Events & Error Analysis</h2><div class='success'><h4>✅ No Critical Security Events Found</h4><p>No critical security events were detected in the last 7 days, or the event log analysis encountered issues.</p></div>    </div>

    <div class="section">
        <h2>👥 Security Group Nesting Analysis</h2><div class='metric'><div class='number'>51</div><div class='label'>Total Groups</div></div><div class='metric'><div class='number'>2</div><div class='label'>With Nested Groups</div></div><div class='metric'><div class='number'>0</div><div class='label'>Deep Nesting (3+)</div></div><div class='metric'><div class='number'>0</div><div class='label'>Large Groups (100+)</div></div><div class='metric'><div class='number'>38</div><div class='label'>Empty Groups</div></div><div class='controls-panel'><strong>View Controls:</strong> <button class='control-btn' onclick='expandAllGroups()'>Expand All</button><button class='control-btn' onclick='collapseAllGroups()'>Collapse All</button><button class='control-btn' onclick='showAllGroups()'>Show All</button></div><div class='group-tree' id='group-tree'><div class='group-item'><span class='group-toggle' onclick='toggleGroup("CN_Denied_RODC_Password_Replication_Group_CN_Users_DC_demo_DC_local")'><span class='group-name'>Denied RODC Password Replication Group</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 8 (Users: , Computers: 0, Groups: 7) | Nesting Depth: 1</span></span><div class='group-children' id='group-children-CN_Denied_RODC_Password_Replication_Group_CN_Users_DC_demo_DC_local'><div class='group-item'><span class='group-name'>↳ Read-only Domain Controllers</span></div><div class='group-item'><span class='group-name'>↳ Group Policy Creator Owners</span></div><div class='group-item'><span class='group-name'>↳ Domain Admins</span></div><div class='group-item'><span class='group-name'>↳ Cert Publishers</span></div><div class='group-item'><span class='group-name'>↳ Enterprise Admins</span></div><div class='group-item'><span class='group-name'>↳ Schema Admins</span></div><div class='group-item'><span class='group-name'>↳ Domain Controllers</span></div></div></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Users</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 3 (Users: 0, Computers: 0, Groups: )</span></span></div><div class='group-item'><span class='group-toggle' onclick='toggleGroup("CN_Administrators_CN_Builtin_DC_demo_DC_local")'><span class='group-name'>Administrators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 3 (Users: , Computers: 0, Groups: 2) | Nesting Depth: 1</span></span><div class='group-children' id='group-children-CN_Administrators_CN_Builtin_DC_demo_DC_local'><div class='group-item'><span class='group-name'>↳ Domain Admins</span></div><div class='group-item'><span class='group-name'>↳ Enterprise Admins</span></div></div></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Guests</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 2 (Users: , Computers: 0, Groups: )</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>test SGroup</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 1 (Users: 0, Computers: 0, Groups: )</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Pre-Windows 2000 Compatible Access</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 1 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>IIS_IUSRS</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 1 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>new test Sgroup</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 1 (Users: , Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Group Policy Creator Owners</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 1 (Users: , Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Schema Admins</span><span class='group-scope'>[Universal]</span><span class='group-stats'>Members: 1 (Users: , Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Domain Admins</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 1 (Users: , Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Enterprise Admins</span><span class='group-scope'>[Universal]</span><span class='group-stats'>Members: 1 (Users: , Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Windows Authorization Access Group</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 1 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>RDS Management Servers</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Enterprise Key Admins</span><span class='group-scope'>[Universal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Certificate Service DCOM Access</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Event Log Readers</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Cryptographic Operators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>RDS Endpoint Servers</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>RDS Remote Access Servers</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Incoming Forest Trust Builders</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Account Operators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Enterprise Read-only Domain Controllers</span><span class='group-scope'>[Universal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Terminal Server License Servers</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Server Operators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Access Control Assistance Operators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Hyper-V Administrators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Storage Replica Administrators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Remote Management Users</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Distributed COM Users</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Protected Users</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Cloneable Domain Controllers</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Key Admins</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Cert Publishers</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>DnsUpdateProxy</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Domain Controllers</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 2, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Domain Computers</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: , Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Domain Users</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 0 (Users: 11, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Read-only Domain Controllers</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Domain Guests</span><span class='group-scope'>[Global]</span><span class='group-stats'>Members: 0 (Users: , Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>RAS and IAS Servers</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Remote Desktop Users</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Replicator</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Network Configuration Operators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Performance Log Users</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Performance Monitor Users</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>DnsAdmins</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Allowed RODC Password Replication Group</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Windows Admin Center CredSSP</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Backup Operators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div><div class='group-item'><span class='group-item'>&nbsp;&nbsp;&nbsp;<span class='group-name'>Print Operators</span><span class='group-scope'>[DomainLocal]</span><span class='group-stats'>Members: 0 (Users: 0, Computers: 0, Groups: 0)</span></span></div></div>    <script>
    function toggleGroup(groupId) {
        var toggle = event.target.closest('.group-toggle');
        var children = document.getElementById('group-children-' + groupId);
        
        if (children) {
            if (children.classList.contains('show')) {
                children.classList.remove('show');
                toggle.classList.remove('expanded');
            } else {
                children.classList.add('show');
                toggle.classList.add('expanded');
            }
        }
    }
    
    function expandAllGroups() {
        var allToggles = document.querySelectorAll('.group-toggle');
        var allChildren = document.querySelectorAll('.group-children');
        
        allToggles.forEach(function(toggle) {
            toggle.classList.add('expanded');
        });
        
        allChildren.forEach(function(child) {
            child.classList.add('show');
        });
    }
    
    function collapseAllGroups() {
        var allToggles = document.querySelectorAll('.group-toggle');
        var allChildren = document.querySelectorAll('.group-children');
        
        allToggles.forEach(function(toggle) {
            toggle.classList.remove('expanded');
        });
        
        allChildren.forEach(function(child) {
            child.classList.remove('show');
        });
    }
    
    function showAllGroups() {
        var allGroups = document.querySelectorAll('.group-item');

        allGroups.forEach(function(group) {
            group.style.display = 'block';
        });
    }
    </script>    </div>
    <div class="section">
        <h2>🔑 Group Managed Service Accounts (gMSA) Usage</h2><p><strong>Status:</strong> No gMSA accounts found.</p><div class='recommendation'>Recommendation: Consider implementing Group Managed Service Accounts (gMSA) for better security, automated password management, and Kerberos authentication.</div></div>
<div class='section'>
    <h2>🔐 Local Administrator Password Solution (LAPS) Audit</h2><p>No LAPS data found or unable to retrieve.</p>    </div>

    <div class='section'>
        <h2>🔐 Protocol Security Analysis (LLMNR, SMB, TLS, NTLM)</h2><table>
        <tr>
            <th>Domain Controller</th>
            <th>SMBv1 Enabled</th>
            <th>SMBv2 Enabled</th>
            <th>SMBv3 Enabled</th>
            <th>LLMNR Disabled</th>
            <th>TLS 1.0</th>
            <th>TLS 1.1</th>
            <th>TLS 1.2</th>
            <th>TLS 1.3</th>
            <th>NTLM Audit</th>
        </tr><tr class=''>
            <td></td>
            <td>Error</td>
            <td>Error</td>
            <td>Error</td>
            <td>Unknown</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>Error</td>
        </tr><tr class=''>
            <td></td>
            <td>Error</td>
            <td>Error</td>
            <td>Error</td>
            <td>Unknown</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>Error</td>
        </tr></table>        <h3>Protocol Security Recommendations</h3>
        <ul>
            <li><strong>SMBv1:</strong> Disable SMBv1 as it is insecure and vulnerable to exploits like WannaCry.</li>
            <li><strong>SMBv2/SMBv3:</strong> Keep these enabled but ensure security features (signing/encryption) are enforced where needed.</li>
            <li><strong>LLMNR:</strong> Disable to reduce exposure to name resolution poisoning attacks.</li>
            <li><strong>TLS Versions:</strong> Disable TLS 1.0 and 1.1; ensure TLS 1.2 and 1.3 are enabled for secure communications.</li>
            <li><strong>NTLM Audit:</strong> Configure auditing to monitor and reduce NTLM usage.</li>
        </ul></div>
<div class='section'>
    <h2>🛡 Protocols & Legacy Services Audit</h2><table>
        <tr><th>Setting</th><th>Status</th></tr><tr><td>TLS 1.0 Enabled (Client)</td><td>No</td></tr><tr><td>TLS 1.1 Enabled (Client)</td><td>No</td></tr><tr><td>SMBv1 Installed</td><td>No</td></tr><tr><td>LLMNR</td><td>Not Configured</td></tr><tr><td>TLS 1.0 Enabled (Server)</td><td>No</td></tr><tr><td>SMBv1 Enabled</td><td>No</td></tr><tr><td>NetBIOS</td><td>Default</td></tr><tr><td>TLS 1.1 Enabled (Server)</td><td>No</td></tr></table>    </div>
    <div class="section">
        <h2>🔍 Orphaned SIDs in Active Directory ACLs</h2><div class='metric'><div class='number'>1</div><div class='label'>Total Orphaned SIDs Found</div></div><h3>Top Objects with Most Orphaned SIDs</h3><table><tr><th>Distinguished Name</th><th>Orphaned SIDs Count</th></tr><tr><td>CN=test SGroup,OU=DRH,OU=company,DC=demo,DC=local</td><td>1</td></tr></table>    </div>

    <div class="section">
        <h2>👤 Privileged Account Monitoring</h2>
        <div class="subsection">
            <h3>Administrative Groups Analysis</h3>
            <table>
                <tr>
                    <th>Group Name</th>
                    <th>Member Count</th>
                    <th>Last Modified</th>
                    <th>Inactive Members</th>
                </tr>                <tr>
                    <td><strong>Domain Admins</strong></td>
                    <td></td>
                    <td></td>
                    <td>0</td>
                </tr>                <tr>
                    <td><strong>Enterprise Admins</strong></td>
                    <td></td>
                    <td></td>
                    <td>0</td>
                </tr>                <tr>
                    <td><strong>Schema Admins</strong></td>
                    <td></td>
                    <td></td>
                    <td>0</td>
                </tr>                <tr>
                    <td><strong>Administrators</strong></td>
                    <td>3</td>
                    <td></td>
                    <td>0</td>
                </tr>                <tr>
                    <td><strong>Backup Operators</strong></td>
                    <td>0</td>
                    <td></td>
                    <td>0</td>
                </tr>                <tr>
                    <td><strong>Print Operators</strong></td>
                    <td>0</td>
                    <td></td>
                    <td>0</td>
                </tr>                <tr>
                    <td><strong>Group Policy Creator Owners</strong></td>
                    <td></td>
                    <td></td>
                    <td>0</td>
                </tr>                <tr>
                    <td><strong>DNS Admins</strong></td>
                    <td>0</td>
                    <td></td>
                    <td>0</td>
                </tr>            </table>
        </div>

        <div class="subsection">
            <h3>Service Accounts with High Privileges</h3>
            <table>
                <tr>
                    <th>Account Name</th>
                    <th>Privileged Groups</th>
                    <th>Last Logon</th>
                    <th>Status</th>
                </tr>                <tr><td colspan="4">No privileged service accounts found</td></tr>            </table>
        </div>

        <div class="subsection">
            <h3>Inactive Privileged Accounts (90+ days)</h3>
            <table>
                <tr>
                    <th>User</th>
                    <th>Group</th>
                    <th>Last Logon</th>
                    <th>Days Inactive</th>
                </tr>                <tr><td colspan="4">No inactive privileged accounts found</td></tr>            </table>
        </div>
    </div>

    <div class="section">
        <h2>🛡️ AD Object Protection from Accidental Deletion</h2>        <h3>Protection Overview</h3>
        <div class="metric">
            <div class="number">22.7%</div>
            <div class="label">Overall Protection</div>
        </div>
        <div class="metric">
            <div class="number">5/6</div>
            <div class="label">Protected OUs</div>
        </div>
        <div class="metric">
            <div class="number">0/4</div>
            <div class="label">Protected Containers</div>
        </div>
        <div class="metric">
            <div class="number">0/2</div>
            <div class="label">Protected Critical Users</div>
        </div>
        <div class="metric">
            <div class="number">0/1</div>
            <div class="label">Protected Service Accounts</div>
        </div>
        <div class="metric">
            <div class="number">0/10</div>
            <div class="label">Protected Critical Groups</div>
        </div>
        
        <h3>Unprotected Objects (High Risk)</h3>        <div class="subsection">
            <h4>🚨 Unprotected Organizational Units (1)</h4>
            <table>
                <tr>
                    <th>OU Name</th>
                    <th>Distinguished Name</th>
                    <th>Description</th>
                </tr>                <tr>
                    <td><strong>Domain Controllers</strong></td>
                    <td>OU=Domain Controllers,DC=demo,DC=local</td>
                    <td>Default container for domain controllers</td>
                </tr></table></div>        <div class="subsection">
            <h4>🚨 Unprotected Critical Users (2)</h4>
            <table>
                <tr>
                    <th>User Name</th>
                    <th>Sam Account Name</th>
                    <th>Type</th>
                    <th>Service Principal Names</th>
                </tr>                <tr>
                    <td><strong>adminuser</strong></td>
                    <td>adminuser</td>
                    <td>Admin User</td>
                    <td>N/A</td>
                </tr>                <tr>
                    <td><strong>krbtgt</strong></td>
                    <td>krbtgt</td>
                    <td>Service Account</td>
                    <td>kadmin/changepw</td>
                </tr></table></div>        <div class="subsection">
            <h4>🚨 Unprotected Critical Groups (10)</h4>
            <table>
                <tr>
                    <th>Group Name</th>
                    <th>Group Scope</th>
                    <th>Distinguished Name</th>
                </tr>                <tr>
                    <td><strong>Domain Admins</strong></td>
                    <td>Global</td>
                    <td>CN=Domain Admins,CN=Users,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Enterprise Admins</strong></td>
                    <td>Universal</td>
                    <td>CN=Enterprise Admins,CN=Users,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Schema Admins</strong></td>
                    <td>Universal</td>
                    <td>CN=Schema Admins,CN=Users,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Administrators</strong></td>
                    <td>DomainLocal</td>
                    <td>CN=Administrators,CN=Builtin,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Account Operators</strong></td>
                    <td>DomainLocal</td>
                    <td>CN=Account Operators,CN=Builtin,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Server Operators</strong></td>
                    <td>DomainLocal</td>
                    <td>CN=Server Operators,CN=Builtin,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Backup Operators</strong></td>
                    <td>DomainLocal</td>
                    <td>CN=Backup Operators,CN=Builtin,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Print Operators</strong></td>
                    <td>DomainLocal</td>
                    <td>CN=Print Operators,CN=Builtin,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Group Policy Creator Owners</strong></td>
                    <td>Global</td>
                    <td>CN=Group Policy Creator Owners,CN=Users,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>DnsAdmins</strong></td>
                    <td>DomainLocal</td>
                    <td>CN=DnsAdmins,CN=Users,DC=demo,DC=local</td>
                </tr></table></div>        <div class="warning">
            <h4>⚠️ Unprotected Containers (4)</h4>
            <table>
                <tr>
                    <th>Container Name</th>
                    <th>Distinguished Name</th>
                </tr>                <tr>
                    <td><strong>Users</strong></td>
                    <td>CN=Users,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Computers</strong></td>
                    <td>CN=Computers,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>ForeignSecurityPrincipals</strong></td>
                    <td>CN=ForeignSecurityPrincipals,DC=demo,DC=local</td>
                </tr>                <tr>
                    <td><strong>Managed Service Accounts</strong></td>
                    <td>CN=Managed Service Accounts,DC=demo,DC=local</td>
                </tr></table></div><h3>Protection Recommendations</h3><div class='warning'><ul><li>Found 1 unprotected OUs. Consider enabling protection for critical organizational units.</li><li>Found 4 unprotected containers. Review and protect important containers from accidental deletion.</li><li>Found 2 unprotected critical users (admins/service accounts). Enable protection for privileged accounts.</li><li>Found 1 unprotected service accounts. Service accounts should always be protected from accidental deletion.</li><li>Found 10 unprotected critical groups. Administrative groups should be protected from accidental deletion.</li><li>Only 22.7% of critical AD objects are protected from accidental deletion. Aim for 100% protection of critical infrastructure objects.</li></ul></div> += @"
    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    </div> <!-- Close container-fluid -->
</body>
</html>
